<body>  <div id="container">    <div id="background"></div>    <table cellpadding="0" cellspacing="0">      <thead>        <tr>          <th class="docs">            <h1>            	<h2>              		PermisosFAPDocumentacion            	</h2>            </h1>          </th>          <th class="code">          </th>        </tr>      </thead>      <tbody>                                    <tr id="section-1">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-1">&#182;</a>              		</div>                 	<p>Permisos de administracion</p>            	 	</td>            	<td class="code">            		<pre>Permiso administrador{<br/>	when<br/>		agente.rolActivo = "administrador"<br/>	return all<br/>}<br/><br/>Permiso adminOrGestor{<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor")<br/>	return all<br/>}<br/><br/>Permiso usuario{<br/>	when<br/>		agente.rolActivo = "usuario"<br/>	return all<br/>}<br/><br/>Permiso noUsuario{<br/>	when<br/>		agente.rolActivo != "usuario"<br/>	return all<br/>}<br/><br/>Permiso noEvaluador {<br/>	when<br/>		agente.rolActivo != "evaluador"<br/>	return<br/>		all<br/>}<br/><br/>Permiso logeado{<br/>	when <br/>		agente != null<br/>	return all<br/>}<br/><br/>Permiso noLogeado{<br/>	when <br/>		agente = null<br/>	return all<br/>}		              		</pre>            	</td>          </tr>                            <tr id="section-2">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-2">&#182;</a>              		</div>                 	<p>Permisos de la pag presentacion</p>            	 	</td>            	<td class="code">            		<pre>Permiso presentacionPrepararParaFirmar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.registro.fasesRegistro.borrador = "false"<br/>	return editable<br/><br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor")<br/>	return visible<br/>}<br/><br/>Permiso presentacionModificar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.registro.fasesRegistro.registro = "false"<br/>	return editable<br/><br/>	else<br/>	return visible		<br/>}<br/><br/>Permiso presentacionObtenerBorrador{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.registro.fasesRegistro.borrador = "true"<br/>	return editable<br/>}<br/><br/>Permiso presentacionFirmar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and <br/>		solicitud?.registro.fasesRegistro.borrador = "true" and<br/>		solicitud.registro.fasesRegistro.firmada = "false"<br/>	return editable<br/><br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.registro.fasesRegistro.borrador = "true"<br/>	return visible<br/>}<br/><br/>Permiso presentacionRegistrar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.registro.fasesRegistro.firmada = "true" and<br/>		(<br/>			agente.rolActivo = "usuario" and<br/>			solicitud.registro.fasesRegistro.registro = "false"<br/>		) or<br/>		(<br/>			agente.rolActivo in ("administrador", "gestor") and<br/>			solicitud.registro.fasesRegistro.clasificarAed = "false"<br/>		)<br/>	return editable<br/><br/>	when<br/>		solicitud?.registro.fasesRegistro.firmada = "true"<br/>	return visible	<br/>}<br/><br/>Permiso presentacionRecibo{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.registro.fasesRegistro.registro = "true"<br/>	return editable	<br/>}	<br/><br/>Permiso instruccion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.estado = "iniciada"<br/>	return editable		<br/>}<br/><br/>Permiso solicitudPreparadaFirmarYPresentar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.estado = "borrador" and<br/>		solicitud.registro.fasesRegistro.borrador = "true"<br/>	return all<br/><br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor")<br/>	return leer<br/>}<br/><br/>Permiso editableSiSolicitudIniciada{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.estado in ("Iniciada", "Requerida", "Requerida plazo vencido", "En verificación", "Pendiente requerimiento", "Excluido", "Plazo vencido", "Verificado")<br/>	return all<br/>}<br/><br/>Permiso solicitudPreparadaFirmar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.estado = "borrador"  and<br/>		solicitud.registro.fasesRegistro.borrador != null and<br/>		solicitud.registro.fasesRegistro.borrador = "true"<br/>	return all<br/><br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor")<br/>	return leer<br/>}<br/><br/>Permiso solicitudPreparadaPresentar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor") and<br/>		solicitud?.estado = "borrador" and<br/>		solicitud.registro.fasesRegistro.borrador != null and<br/>		solicitud.registro.fasesRegistro.borrador = "true" and<br/>		solicitud.registro.fasesRegistro.firmada = "true"<br/>	return all<br/><br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor")<br/>	return leer<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-3">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-3">&#182;</a>              		</div>                 	<p>Permiso que define las solicitudes que son visibles para el usuario</p>            	 	</td>            	<td class="code">            		<pre>Permiso solicitudes{<br/>	mensaje = "No tiene suficientes privilegios para acceder a esta solicitud"<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Participacion participacion : sql("select p from Participacion p where p.agente=? AND p.solicitud=?", agente, solicitud)<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor")<br/>		or<br/>		participacion != null 			<br/>	return all<br/>	when<br/>		agente.rolActivo in ("evaluador", "lector")<br/>	return<br/>		leer<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-4">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-4">&#182;</a>              		</div>                 	<p>Permisos pagina de presentacion</p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-5">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-5">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso adminGestorRevisor{<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor")<br/>	return editable<br/>}<br/><br/>Permiso adminGestorRevisorEvaluador{<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor", "evaluador")<br/>	return editable<br/>}<br/><br/>Permiso aportacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when <br/>		agente.rolActivo in ("administrador", "usuario", "gestor", "revisor") and<br/>		solicitud?.estado != "borrador"<br/>	return all<br/>}<br/><br/>Permiso aportacionDocumentos{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "usuario", "gestor", "revisor") and<br/>		solicitud?.estado not in ("borrador")<br/>	return editable<br/>}<br/><br/>Permiso incorporarDocumentos {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor") and<br/>		solicitud?.estado not in ("borrador")<br/>	return<br/>		all<br/>}<br/><br/>Permiso noEditable{<br/>	return visible<br/>}<br/><br/>Permiso noVisibleUsuario{<br/>	when<br/>		usuario is visible<br/>	return denegar<br/>	else return all<br/>}<br/><br/>Permiso solicitudEnBorrador{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.estado = "borrador"	<br/>	return all<br/>}<br/><br/>Permiso editarSolicitud {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Convocatoria convocatoria<br/>	when<br/>		agente.rolActivo in ("evaluador", "lector")<br/>	return<br/>		leer<br/>	when<br/>		!usuario is visible<br/>		or (<br/>	 		agente.rolActivo = "usuario" and<br/>	 		solicitud?.estado = "borrador" and<br/>	 		solicitud?.registro?.fasesRegistro?.borrador = "false" and<br/>	 		convocatoria.estado in ("presentacion")<br/>		)<br/>	return all<br/>	when<br/>		!usuario is visible<br/>		or (<br/>	 		agente.rolActivo = "usuario"<br/>		)<br/>	return [leer]<br/>}<br/><br/>Permiso editarFirma {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Participacion participacion : sql("select p from Participacion p where p.agente=? AND p.solicitud=?", agente, solicitud)<br/>	when<br/>		!usuario is visible<br/>		or (<br/>			(participacion.tipo != "autorizado") and<br/>	 		(agente.rolActivo = "usuario" and<br/>	 		solicitud?.estado = "borrador" and<br/>	 		solicitud?.registro?.fasesRegistro?.borrador = "false"<br/>			)<br/>		)<br/>	return [editar leer]<br/>	when<br/>		!usuario is visible<br/>		or (<br/>	 		agente.rolActivo = "usuario"<br/>		) or (<br/>			participacion.tipo = "autorizado"<br/>		)<br/>	return [leer]<br/>}<br/><br/><br/>Permiso participacionEnSolicitud {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Participacion participacion : sql("select p from Participacion p where p.agente=? AND p.solicitud=?", agente, solicitud)<br/>	when<br/>		participacion != null<br/>	return all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-6">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-6">&#182;</a>              		</div>                 	<p>Indica el permiso que se tiene sobre la solicitud + Administrador: editable + usuario con participación: editable + resto: none</p>            	 	</td>            	<td class="code">            		<pre>Permiso permisoSolicitud {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		adminOrGestor contains _accion<br/>	return all<br/><br/>	when<br/>		participacionEnSolicitud contains _accion<br/>	return all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-7">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-7">&#182;</a>              		</div>                 	<p>Este permiso lo tienen todas las páginas de la solicitud Controla que los datos no se puedan editar cuando la solicitud está preparada para registrar</p>            	 	</td>            	<td class="code">            		<pre>Permiso solicitud {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		adminOrGestor contains _accion<br/>	return editar<br/><br/>	when<br/>		participacionEnSolicitud contains _accion and<br/>	 	agente.rolActivo = "usuario" and<br/>	 	solicitud?.estado = "borrador" and<br/>	 	solicitud?.registro?.fasesRegistro?.borrador = "false"<br/>	return editar<br/><br/>	when<br/>		participacionEnSolicitud contains _accion<br/>	return leer<br/>}<br/><br/>Permiso subirDocumentos{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		adminOrGestor contains _accion<br/>		or (<br/>	 		solicitud?.estado = "borrador" and<br/>	 		solicitud?.registro?.fasesRegistro?.borrador = "false"<br/>		)<br/>	return crear<br/>}<br/><br/>Permiso visibleSiAccesoCertificado{<br/>	when <br/>		agente.acceso = "certificado"<br/>	return all<br/>}<br/><br/>Permiso visibleSiAccesoContrasena{<br/>	when <br/>		agente.acceso = "usuario"<br/>	return all<br/>}<br/><br/>Permiso documentoAutorizacionGenerado{<br/>	vars <br/>		SolicitudGenerica solicitud<br/>	when <br/>		solicitud?.registro?.autorizacionFuncionario?.urlDescarga != null and<br/>		agente.funcionario != "true"<br/>	return all<br/>}<br/><br/>Permiso visibleFuncionarioAutorizado{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when <br/>		agente.funcionario = "true" and<br/>		solicitud?.solicitante?.autorizaFuncionario = "true"<br/>	return all<br/>}<br/><br/>Permiso noVisibleFuncionarioAutorizado{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when <br/>		agente.funcionario = "true" and<br/>		solicitud?.solicitante?.autorizaFuncionario = "true"<br/>	return denegar<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-8">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-8">&#182;</a>              		</div>                 	<p>/* Se puede moficicar la aportación de documentación cuando está en borrador*/	</p>            	 	</td>            	<td class="code">            		<pre>Permiso aportacionModificar{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.aportaciones?.actual?.estado in ("borrador")<br/>	return editable<br/>}	<br/>              		</pre>            	</td>          </tr>                            <tr id="section-9">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-9">&#182;</a>              		</div>                 	<p>/*   Cuando la firma y registro se quedo en un paso intermedio. Se le muestra un mensaje   al usuario diciendole que hubo un problema, que pulse otra vez el problema para   completar el registro  </p>            	 	</td>            	<td class="code">            		<pre>Permiso aportacionMensajeIntermedio{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.aportaciones?.actual?.estado in ("firmada", "registrada", "clasificada", "finalizada")<br/>	return editable<br/>}              		</pre>            	</td>          </tr>                            <tr id="section-10">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-10">&#182;</a>              		</div>                 	/*  * Permisos de la pagina de presentacion */            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-11">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-11">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso mensajeVerificacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor") and<br/>		solicitud?.estado = "requerida plazo vencido"<br/>	return leer<br/>}<br/><br/>Permiso iniciarVerificacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor") and<br/>		solicitud?.verificacion?.estado = "iniciada" and<br/>		(solicitud?.estado in (/*"iniciada", "verificado",*/ "enVerificacion"))<br/><br/>	return all<br/>}<br/><br/>Permiso verificarDocumentos{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Verificacion verificacion<br/>	when<br/>		(agente.rolActivo in ("administrador", "gestor", "revisor")) and<br/>		(<br/>			(_accion in (leer, editar))<br/>			and (solicitud?.estado in ("enVerificacion", "excluido"))<br/>			and verificacion?.estado != null<br/>			and verificacion?.estado in ("enVerificacion", "obtenerNoProcede")<br/>		)	<br/>	return <br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-12">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-12">&#182;</a>              		</div>                 	<ul><li>Además Sobreescribimos </li></ul>            	 	</td>            	<td class="code">            		<pre>Permiso verificarObtenerNoProcede{<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		(agente.rolActivo in ("administrador", "gestor", "revisor")) and<br/>		(<br/>			(_accion in (leer, editar))<br/>			and verificacion?.estado in ("obtenerNoProcede")<br/>		)	<br/>	return <br/>		all<br/>}<br/><br/>Permiso aportacionNoNull{<br/>	vars<br/>		Documento doc<br/>	when<br/>		doc?.uri = null<br/>	return editable<br/>}<br/><br/>Permiso nuevaSolicitud{<br/>	vars<br/>		Convocatoria convocatoria<br/>	when<br/>		convocatoria?.estado = "presentacion"<br/>	return all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-13">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-13">&#182;</a>              		</div>                 	<p>Baremación	</p>            	 	</td>            	<td class="code">            		<pre>Permiso listaEvaluaciones{<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor", "evaluador")<br/>	return editable<br/>}<br/><br/>Permiso evaluacion{<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor", "evaluador")<br/>	return all<br/>}<br/><br/>Permiso accesoEvaluacion {<br/>	vars<br/>		Evaluacion evaluacion<br/>	when<br/>		( <br/>			_accion = editar and<br/>		    agente?.rolActivo in ("administrador", "gestor", "revisor", "evaluador") and<br/>		    (evaluacion?.estado in ("enTramite"))<br/>		)<br/>	return<br/>		all<br/><br/>	when <br/>		(<br/>           	_accion = leer and<br/>           	 agente?.rolActivo in ("administrador", "gestor", "revisor", "evaluador") and<br/>		    (evaluacion?.estado in ("enTramite", "evaluada", "rechazada"))<br/>		)<br/>	return<br/>		visible<br/>}<br/><br/>Permiso guardarEvaluacion {<br/>	vars<br/>		Evaluacion evaluacion<br/>	when<br/>		( <br/>			_accion = editar and<br/>		    agente?.rolActivo in ("administrador", "gestor", "revisor", "evaluador") and<br/>		    (evaluacion?.estado in ("enTramite"))<br/>		)<br/>	return<br/>		all<br/>}<br/><br/>Permiso tableKeyOnlyEstadosSolicitud{<br/>	vars<br/>		TableKeyValue tableKeyValue<br/>	when<br/>		tableKeyValue?.table = "estadosSolicitud"<br/>	return all<br/>}<br/><br/>Permiso tableKeyOnlyEstadosSolicitudUsuario{<br/>	vars<br/>		TableKeyValue tableKeyValue<br/>	when<br/>		tableKeyValue?.table = "estadosSolicitudUsuario"<br/>	return editable<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-14">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-14">&#182;</a>              		</div>                 	<p>Editable administrador Visible para el usuario</p>            	 	</td>            	<td class="code">            		<pre>Permiso editAdminGestorVisibleUser {<br/>	when<br/>		adminOrGestor is visible<br/>	return all<br/><br/>	when<br/>		usuario is visible<br/>	return visible<br/>}<br/><br/><br/>Permiso noHayverificacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Verificacion verificacion : sql("select verificacion from SolicitudGenerica s where s.id=?", solicitud.id)<br/>	when<br/>		(agente.rolActivo in ("administrador", "gestor", "revisor")) and ((verificacion = null) or ((verificacion.estado=null) or (verificacion.estado in ("enRequerido", "plazoVencido", "verificacionPositiva", "verificacionNegativa"))))<br/>	return<br/>		all<br/>}<br/><br/>Permiso hayverificacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Verificacion verificacion : sql("select verificacion from SolicitudGenerica s where s.id=?", solicitud.id)<br/>	when<br/>		(agente.rolActivo in ("administrador", "gestor", "revisor")) and ((verificacion != null) and (verificacion.estado!=null) and (verificacion.estado in ("iniciada", "verificandoTipos", "obtenerNoProcede", "enVerificacion", "enVerificacionNuevosDoc", "enRequerimiento", "enRequerimientoFirmaSolicitada")))<br/>	return<br/>    	all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-15">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-15">&#182;</a>              		</div>                 	<p>Permiso fantasma, ya que va a ser sobrescrito para su uso. Lo que en realidad está declarado no es lo que hace. Este permiso comprueba que no haya documentación nueva adjuntada por el solicitante y que no esté en la verificación actual.</p>            	 	</td>            	<td class="code">            		<pre>Permiso hayNuevaDocumentacionVerificacion{<br/>	when<br/>		agente.rolActivo != null<br/>	return<br/>		all<br/>}<br/><br/>Permiso verificarTiposDocumentos{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Verificacion verificacion<br/>	when<br/>		(_accion in (leer, editar)) and <br/>		(agente.rolActivo in ("administrador", "gestor", "revisor")) and<br/>		(solicitud?.estado = "enVerificacion") and<br/>		(verificacion != null and verificacion.estado != null and verificacion.estado in ("verificandoTipos"))<br/>	return<br/>		all<br/>}<br/><br/>Permiso anularVerificacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		Verificacion verificacion<br/>	when<br/>		(_accion = editar) and <br/>		(agente.rolActivo in ("administrador", "gestor")) and<br/>		(solicitud?.estado = "enVerificacion") and<br/>		(verificacion?.requerimiento?.registro?.fasesRegistro?.registro != "true") and<br/>		(verificacion?.requerimiento?.registro?.fasesRegistro?.firmada != "true") and<br/>		(verificacion?.estado != null and verificacion?.estado in ("enVerificacion", "verificandoTipos", "obtenerNoProcede", "enVerificacionNuevosDoc", "enRequerido", "enRequerimiento", "enRequerimientoFirmaSolicitada"))<br/>	return<br/>		all<br/>}<br/><br/>Permiso verificacionConNuevosDoc{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(agente.rolActivo in ("administrador", "gestor", "revisor"))<br/>		and (solicitud?.verificacion?.estado != null) and (solicitud?.verificacion?.estado = "enVerificacionNuevosDoc") <br/>	return<br/>    	all<br/>}<br/><br/>Permiso accederSiSolicituNoBorrador{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when <br/>		(agente.rolActivo in ("administrador", "usuario", "gestor", "revisor")) and<br/>		(solicitud?.estado != "borrador")<br/>	return <br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-16">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-16">&#182;</a>              		</div>                 	<p>Permiso que controla si se pueden loguear con usuario y contraseña SOBREESCRITO EN SECUREFAP.JAVA</p>            	 	</td>            	<td class="code">            		<pre>Permiso loginTipoUser{<br/>	vars<br/>		Agente ag<br/>	when<br/>		(agente.rolActivo = "administrador") and<br/>		(ag?.acceso != "certificado")<br/>	return <br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-17">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-17">&#182;</a>              		</div>                 	<p>Para mostrar en las páginas únicamente el agente perteneciente al usuario logueado</p>            	 	</td>            	<td class="code">            		<pre>Permiso miAgente{<br/>	vars <br/>		Agente agenteActual <br/>	when <br/>		agenteActual?.id = agente?.id<br/>	return<br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-18">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-18">&#182;</a>              		</div>                 	<p>Permiso que controla que se muestra la búsqueda en la pantalla inicial SOBREESCRITO EN SECUREFAP.JAVA</p>            	 	</td>            	<td class="code">            		<pre>Permiso listaSolicitudesConBusqueda{<br/>	when<br/>		agente.rolActivo != "usuario"<br/>	return <br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-19">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-19">&#182;</a>              		</div>                 	<p>Permiso que controla que no se muestra la búsqueda en la pantalla inicial SOBREESCRITO EN SECUREFAP.JAVA</p>            	 	</td>            	<td class="code">            		<pre>Permiso listaSolicitudesSinBusqueda{<br/>	when<br/>		agente.rolActivo = "usuario"<br/>	return <br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-20">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-20">&#182;</a>              		</div>                 	<p>Permiso para saber el estado de la búsqueda (si no se ha buscado todavía, no mostramos la tabla de resultados) SOBREESCRITO EN SECUREFAP.JAVA</p>            	 	</td>            	<td class="code">            		<pre>Permiso mostrarResultadoBusqueda{<br/>	when<br/>		agente.rolActivo != "usuario"<br/>	return<br/>		all<br/>}<br/><br/><br/>Permiso prepararDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro?.borrador = "false")<br/>	return<br/>		all<br/>}<br/><br/>Permiso generarBorradorDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud?.desistimiento?.motivo != null<br/>	return<br/>		all<br/>}<br/><br/>Permiso enBorradorDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro?.borrador="true")<br/>	return<br/>		all<br/>}<br/><br/>Permiso editarDesistimiento {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when <br/>		(solicitud?.desistimiento?.registro?.fasesRegistro?.registro="false")<br/>	return<br/>		editable<br/>}<br/><br/>Permiso modificarDesistimiento{<br/>	vars<br/>	 	SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro?.registro="false")<br/>	return<br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-21">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-21">&#182;</a>              		</div>                 	<p>/*  * Permiso "instruccionDesistimiento  * Se concede permiso si la fecha de cierre de desistimiento no se ha cumplido  *  * - Regla sobreescrita  </p>            	 	</td>            	<td class="code">            		<pre>Permiso instruccionDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		solicitud.id = solicitud.id<br/>	return<br/>		all<br/>}<br/><br/>Permiso mensajeIntermedioDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro.firmada = "true" or<br/>		solicitud?.desistimiento?.registro?.fasesRegistro.registro = "true" or<br/>		solicitud?.desistimiento?.registro?.fasesRegistro.expedienteAed = "true") and<br/>		solicitud?.desistimiento?.registro?.fasesRegistro.clasificarAed = "false"<br/>	return<br/>		all<br/>}<br/><br/><br/>Permiso clasificadaDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro.clasificarAed="true")<br/>	return<br/>		visible<br/>}<br/><br/>Permiso firmarRegistrarDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro.clasificarAed="false")<br/>	return<br/>		all<br/>}<br/><br/>Permiso firmarDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro.firmada="false")<br/>	return<br/>		all<br/>}<br/><br/><br/>Permiso registrarDesistimiento{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.desistimiento?.registro?.fasesRegistro.firmada = "true" and<br/>		solicitud?.desistimiento?.registro?.fasesRegistro.clasificarAed = "false")<br/>	return<br/>		all<br/>}<br/><br/><br/>Permiso verTablaCEconomicosOtros{<br/>	vars<br/>		CEconomico ceconomico<br/>	when<br/>		ceconomico?.tipo?.tipoOtro="true"<br/>	return all<br/>}<br/><br/>Permiso iniciarTipoEvaluacion{<br/>	vars<br/>		TipoEvaluacion tipoEvaluacion : sql("select te from TipoEvaluacion te")<br/>	when<br/>		tipoEvaluacion = null<br/>	return<br/>		all<br/>}<br/><br/>Permiso iniciarBaremacion {<br/>	vars<br/>		TipoEvaluacion tipoEvaluacion : sql("select te from TipoEvaluacion te")<br/>	when<br/>		(tipoEvaluacion?.estado = "cargada")<br/>	return<br/>		all<br/>}<br/><br/>Permiso editarSolicitudYIniciarBaremacion {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>		TipoEvaluacion tipoEvaluacion : sql("select te from TipoEvaluacion te")<br/>		Convocatoria convocatoria<br/>	when<br/>		!usuario is visible<br/>		or (<br/>	 		agente.rolActivo = "usuario" and<br/>	 		solicitud?.estado = "borrador" and<br/>	 		solicitud?.registro?.fasesRegistro?.borrador = "false" and<br/>	 		(tipoEvaluacion?.estado = "cargada") and<br/>	 		convocatoria.estado in ("presentacion")<br/>		)<br/>	return all<br/>	when<br/>		!usuario is visible<br/>		or (<br/>	 		agente.rolActivo = "usuario"<br/>		)<br/>	return [leer]<br/>}<br/><br/>Permiso actualizarBaremacion {<br/>	vars<br/>		TipoEvaluacion tipoEvaluacion : sql("select te from TipoEvaluacion te")<br/>	when<br/>		(tipoEvaluacion?.estado = "iniciada")<br/>	return<br/>		all<br/>}<br/><br/>Permiso notificacionEditableSiNoLeida {<br/>	vars<br/>		Notificacion notificacion<br/>	when<br/>		notificacion?.estado != null and notificacion?.estado != "puestaadisposicion"<br/>	return<br/>		visible<br/>	when<br/>		notificacion?.estado != null<br/>	return<br/>		all<br/>}              		</pre>            	</td>          </tr>                            <tr id="section-22">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-22">&#182;</a>              		</div>                 	<p>Permisos sobre Requerimientos</p>            	 	</td>            	<td class="code">            		<pre>Permiso requerimiento {<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		verificacion?.estado in ("enRequerido", "enRequerimiento", "enRequerimientoFirmaSolicitada")<br/>	return<br/>		all<br/>}<br/><br/>Permiso requerimientoAFirmar {<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		agente.rolActivo in ("gestor", "administrador")<br/>		and verificacion?.estado in ("enRequerimiento", "enRequerimientoFirmaSolicitada")<br/>		and (<br/>			verificacion?.requerimiento?.registro?.fasesRegistro?.registro = "false"<br/>			or verificacion?.requerimiento?.notificacion = null<br/>			)<br/>	return<br/>		all<br/>	when<br/>		agente.rolActivo in ("revisor")<br/>		and verificacion?.estado in ("enRequerimiento", "enRequerimientoFirmaSolicitada")<br/>		and (<br/>			verificacion?.requerimiento?.registro?.fasesRegistro?.registro = "false"<br/>			or verificacion?.requerimiento?.notificacion = null<br/>			)<br/>	return<br/>		visible<br/>}<br/><br/>Permiso requerimientoFirmado {<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		verificacion?.requerimiento?.registro?.fasesRegistro?.firmada = "true"<br/>		and verificacion?.requerimiento?.notificacion?.estado != null<br/>		and verificacion?.requerimiento?.notificacion?.estado in ("creada")<br/>	return all<br/>}<br/><br/>Permiso requerimientoRequerirFirma {<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		verificacion?.estado in ("enRequerimiento") and verificacion?.requerimiento?.registro?.fasesRegistro?.firmada != "true"<br/>	return<br/>		all<br/>	when<br/>		verificacion?.estado in ("enRequerimientoFirmaSolicitada") and verificacion?.requerimiento?.registro?.fasesRegistro?.firmada != "true"<br/>	return<br/>		visible<br/>}<br/><br/>Permiso obtenerRequerimiento {<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		verificacion?.estado in ("enRequerimiento", "enRequerimientoFirmaSolicitada", "enRequerido")<br/>	return<br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-23">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-23">&#182;</a>              		</div>                 	<p>/*  * Permiso “prepararSolicitud�?  *  * - Podemos preparar la solicitud siempre que esta no haya sido preparada previamente.  * Una vez que esté preparada para firmar no podríamos “Guardar trámite�?, ni “Añadir documentación�? ni  “Preparar para firmar�?  * Es decir, permitimos editar al aplicar este permiso siempre que Solicitud.registro.faserRegistro.borrador = false  * Si no es así, todos estos botones deberían mostrarse deshabilitados.  </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-24">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-24">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso prepararSolicitud {<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(_accion = editar) and<br/>		(solicitud?.registro?.fasesRegistro?.borrador = "false") and<br/>		(solicitud?.registro?.fasesRegistro?.clasificarAed = "false")<br/>	return<br/>		editable<br/>	when<br/>		(_accion = editar) and<br/>		(solicitud?.registro?.fasesRegistro?.borrador = "true") and<br/>		(solicitud?.registro?.fasesRegistro?.clasificarAed = "false") <br/>	return<br/>		visible<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-25">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-25">&#182;</a>              		</div>                 	<p>/*  * Permiso “enBorradorSolicitud�?  *  * - Podemos visualizar el borrador y pulsar para modificar la solicitud si el borrador se generó previamente  * Por tanto los botones “Obtener borrador�? , “Modificar solicitud�?, “Presentar solicitud�?  se muestran deshabilitados si  * Solicitud.registro.faseRegistro.borrador =false  </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-26">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-26">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso enBorradorSolicitud{ <br/>	vars <br/>		SolicitudGenerica solicitud<br/>	when<br/>		(_accion = leer)<br/>		or (<br/>			(solicitud?.registro?.fasesRegistro?.borrador="true") and<br/>		 	(solicitud?.registro?.fasesRegistro?.clasificarAed="false")<br/>		) <br/>	return<br/>		all<br/>}<br/><br/>Permiso clasificadaSolicitud{<br/>	vars <br/>	 	SolicitudGenerica solicitud<br/>	when              		</pre>            	</td>          </tr>                            <tr id="section-27">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-27">&#182;</a>              		</div>                 	<p>TODO SMB 04/04/2012</p>            	 	</td>            	<td class="code">            		<pre>		(_accion = leer) or<br/>		(solicitud?.registro?.fasesRegistro?.clasificarAed="true")   <br/>	return<br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-28">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-28">&#182;</a>              		</div>                 	<p>/*  * Permiso “modificarSolicitud�?  *  * - Para permitir modificar la aceptación o renuncia también se debe comprobar que no se haya producido el registro de entrada de la solicitud asociada  * Por tanto, también debemos mostrar deshabilitado el botón “Modificar solicitud�? si  * Solicitud.registro.faseregistro.registro =true  </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-29">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-29">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso modificarSolicitud{<br/>vars<br/> 	SolicitudGenerica solicitud<br/>when<br/>	(_accion = leer) or<br/>	(solicitud?.registro?.fasesRegistro?.registro="false")<br/>return<br/>	all<br/>}              		</pre>            	</td>          </tr>                            <tr id="section-30">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-30">&#182;</a>              		</div>                 	/*  * Permiso “mesajeIntermedioSolicitud"              	 	</td>            	<td class="code">            		<pre>Permiso mensajeIntermedioSolicitud{<br/>vars<br/>	SolicitudGenerica solicitud<br/>when<br/>	(solicitud?.registro?.fasesRegistro?.firmada = "true" or<br/>	solicitud?.registro?.fasesRegistro?.registro = "true" or<br/>	solicitud?.registro?.fasesRegistro?.expedienteAed = "true") and<br/>	solicitud?.registro?.fasesRegistro?.clasificarAed = "false"<br/>return<br/>	all<br/>}              		</pre>            	</td>          </tr>                            <tr id="section-31">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-31">&#182;</a>              		</div>                 	<p>/*  * Permiso “firmarRegistrarSolicitud�?  *  * - Este permiso se aplica al botón “Firmar y Registrar�?  * El botón está deshabilitado si Solicitud.registro.faseregistro.clasificadaAED = false  * En el proceso se debería controlar si se ha pasado por todas las fases e intentar recuperarlo de un posible fallo.  * Si ya está firmada, se debería eliminar la firma anterior y proceder a realizar una nueva firma y registro (revisar  * si esto estaba previsto en el código, posiblemente no�?  * Si ya está registrada, se intenta clasificarlo nuevamente  </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-32">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-32">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso firmarRegistrarSolicitud{<br/>vars<br/>	SolicitudGenerica solicitud<br/>when<br/>	(_accion = leer) or<br/>	(solicitud?.registro?.fasesRegistro?.clasificarAed="false")<br/>return<br/>	all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-33">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-33">&#182;</a>              		</div>                 	<p>Permite firmar a un funcionario habilitado</p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-34">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-34">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso firmarRegistrarSolicitudFH{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		((_accion = leer) or<br/>		(solicitud?.registro?.fasesRegistro?.clasificarAed="false"))<br/>		and<br/>		(agente.funcionario="true")<br/>	return<br/>		all<br/>}<br/><br/>Permiso firmarRegistrarAportacionFH{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		((_accion = leer) or<br/>		(solicitud?.aportaciones?.actual?.estado!="finalizada"))<br/>		and<br/>		(agente.funcionario="true")<br/>	return<br/>		all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-35">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-35">&#182;</a>              		</div>                 	<p>Sobreescrito</p>            	 	</td>            	<td class="code">            		<pre>Permiso esFuncionarioHabilitadoYActivadaProperty{<br/>	when<br/>		(agente.funcionario="true") <br/>	return<br/>		all<br/>}<br/><br/>Permiso habilitarFHPresentacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.registro?.habilitaFuncionario="true")<br/>	return<br/>		visible<br/>	when<br/>		(solicitud?.registro?.habilitaFuncionario=null) or (solicitud?.registro?.habilitaFuncionario="false")<br/>	return<br/>		all<br/>}<br/><br/>Permiso habilitarFHAportacion{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.aportaciones?.actual?.habilitaFuncionario="true")<br/>	return<br/>		visible<br/>	when<br/>		(solicitud?.aportaciones?.actual?.habilitaFuncionario=null) or (solicitud?.aportaciones?.actual?.habilitaFuncionario="false")<br/>	return<br/>		all<br/>}<br/><br/>              		</pre>            	</td>          </tr>                            <tr id="section-36">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-36">&#182;</a>              		</div>                 	<p>/*  * Permiso “firmarSolicitud�?  *  * - Este permiso se aplica al botón firmar.  * Este botón estará deshabilitado siempre que en la fase de registro ya se haya realizado todas las firmas necesaria.  * Hay que comprobar que se hace un correcto control del proceso de firma tanto cuando firma un represente solidario/�?administrador único�?  * o cuando la firma se produce por representantes mancomunados, deben firmar en este caso todos los que se han indicado que tengan tipo  * de representación mancomunada.  </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-37">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-37">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso firmarSolicitud{<br/>vars<br/>	SolicitudGenerica solicitud<br/>when<br/>	(_accion = leer) or<br/>	(solicitud?.registro?.fasesRegistro?.firmada="false")<br/>return<br/>	all<br/>}              		</pre>            	</td>          </tr>                            <tr id="section-38">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-38">&#182;</a>              		</div>                 	<p>/*  * Permiso “registrarSolicitud�?  *  * - Este botón estará habilitado si cumplen las siguientes condiciones:  * La solicitud ha sido firmada y no ha sido aún clasificada en el AED  * Solicitud.registro.faseregistro.firmada = true y solicitud.registro.faseregistro.clasificadaAED  = false  * Hay que tener previsto una recuperación del proceso, es decir, se produjo el registro, pero no la clasificación de recibo obtenido,  * para continuar el proceso en la fase de clasificación.  </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-39">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-39">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso registrarSolicitud{<br/>vars<br/>	SolicitudGenerica solicitud<br/>when<br/>	(_accion = leer) or<br/>	(solicitud?.registro?.fasesRegistro?.firmada = "true" and<br/>		solicitud?.registro?.fasesRegistro?.clasificarAed = "false")<br/>return<br/>	all<br/>}<br/>              		</pre>            	</td>          </tr>                            <tr id="section-40">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-40">&#182;</a>              		</div>                 	<p>/*  * Permiso que nos permite en la pagina Administracion/ConfigurarMensajes ver la página a   * la que le estamos editando el permiso, pero no modificarlo.  *   </p>            	 	</td>            	<td class="code">            		<pre>              		</pre>            	</td>          </tr>                            <tr id="section-41">            	<td class="docs">              		<div class="pilwrap">                		<a class="pilcrow" href="#section-41">&#182;</a>              		</div>                 	            	 	</td>            	<td class="code">            		<pre>Permiso paginaAConfigurar{<br/>	return<br/>		visible<br/>}<br/><br/><br/>Permiso accesoNoCertificado{<br/>	vars<br/>		Agente ag <br/>	when<br/>		ag = null or<br/>		(ag.acceso = null) or<br/>		(ag.acceso != "certificado") <br/>	return<br/>		all<br/>}<br/><br/>Permiso autorizadoNoAutoriza{<br/>	vars<br/>	   SolicitudGenerica solicitud<br/>	   Participacion participacion : sql("select p from Participacion p where p.agente=? AND p.solicitud=? AND p.tipo<>'autorizado'", agente, solicitud)<br/>	when<br/>		agente.rolActivo in ("administrador", "gestor", "revisor")<br/>		or ( agente.rolActivo in ("usuario")<br/>			and participacion != null<br/>		)<br/>	return all<br/>}<br/><br/>Permiso ActivarHabilitarFH{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	when<br/>		(solicitud?.activoFH="true")<br/>	return<br/>		visible<br/>	when<br/>		(solicitud?.activoFH=null) or (solicitud?.activoFH="false")<br/>	return<br/>		all<br/>}<br/><br/>Permiso evaluacionFinalizada{<br/>	vars<br/>		SolicitudGenerica solicitud<br/>	    Evaluacion evaluacion : sql("select evaluacion from Evaluacion evaluacion where evaluacion.solicitud.id=?", solicitud.id)<br/>	when<br/>	    (evaluacion?.tipo?.estado = "evaluada") and<br/>	    (agente.rolActivo in ("administrador", "gestor"))<br/>	return all<br/>}<br/><br/>Permiso obtenerNoProcede{<br/>	vars<br/>		Verificacion verificacion<br/>	when<br/>		((verificacion.estado = "obtenerNoProcede") and<br/>		(agente.rolActivo in ("administrador", "gestor")))<br/>	return all<br/><br/>}              		</pre>            	</td>          </tr>              </tbody>    </table>  </div>  <script>        	$('pre').addClass("prettyprint");	$('pre').css('overflow', 'auto');    prettyPrint();  </script></body>