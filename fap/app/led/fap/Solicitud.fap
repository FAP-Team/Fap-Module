Formulario Solicitud campo=SolicitudGenerica permiso=solicitudes {	

	Pagina DocumentacionFAP titulo = "Documentación" campo=SolicitudGenerica noForm perteneceA ="Documentacion" {
	
        FirmaMasiva documentos titulo="Documentación" campo=SolicitudGenerica.documentacion.documentos paginaCrear=DocumentosFAP popupEditar=DocumentosEditarFAP popupLeer=DocumentosEditarFAP popupBorrar=DocumentosEditarFAP {
            Columna campo=Documento.fechaSubida titulo="Fecha Subida" expandir
            Columna campo=Documento.fechaRegistro titulo="Fecha Registro" expandir
            Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
            Columna campo=Documento.tipo titulo="Tipo Documento"expandir
            Columna campo=Documento.enlaceDescarga titulo="Descargar" expandir
            Columna campo=Documento.enlaceDescargaFirmado titulo="Descargar Firmado" expandir
            Columna campo=Documento.firmadoVisibleLocal titulo="Firmado" expandir
        }
		
		Grupo documentosExternos borde=false mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.documentacion.documentosExternos\")"{
			Grupo docExt titulo="Documentos ya aportados en la Administración"{
				Wiki{"En aplicación del artículo 18 del Decreto 48/2009, de 28 de abril, por el que se establecen en la Administración Pública de la Comunidad Autónoma de Canarias medidas ante la crisis económica y de simplificación administrativa, el interesado puede NO aportar los documentos que ya se encuentren en poder de la Administración y que se relacionan a continuación.
Esta declaración autoriza a la ACIISI a obtener estos documentos y/o datos alternativos de los órganos gestores que se indican."}
				Tabla documentosExternos titulo="Documentos ya aportados en la Administración" campo=SolicitudGenerica.documentacion.documentosExternos paginaCrear=DocumentosExternosFAP popupEditar=DocumentosExternosEditarFAP popupLeer=DocumentosExternosLeerFAP popupBorrar=DocumentosExternosEditarFAP {
					Columna titulo="Tipo Documento" campo=DocumentoExterno.tipo
					Columna titulo="Descripción" campo=DocumentoExterno.descripcionVisible expandir
				}
			}
		}
		
		Grupo borde=false mostrarSiExpresion "solicitud.activoFH==true"{
			Grupo titulo="Habilitar la firma y presentación por Funcionario Público" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")"{
				Wiki{"Para habilitar la firma y presentación por un Funcionario Público, imprima la autorización fírmela y adjúntela como documento en el apartado “Documentación�? de esta página."}
				Form formAbrirPlantillaFH destino="_blank"{
					Boton btnAbrirPlantillaFH titulo="Descargar Autorización"
				}
			}
		}
	}
	
	Pagina DatosTramites noForm titulo="Datos Tramites" campo=SolicitudGenerica {
		Grupo grFechaFinAceptacion titulo="Fecha Fin de Aceptación" ayuda="Info. Aquí se introduce la fecha limite para aceptar acorde con el acceso a la sede." (popover) {
			Form frmFinAceptacion redirigir=DatosTramites {
				Grupo borde=false{
						Fecha titulo="Fecha Fin de Aceptación" campo=SolicitudGenerica.fechaFinDeAceptacion requerido
				}
				Boton btnGuardarFechaFinAceptacion titulo="Guardar"
			}
		}
	
		Grupo grFechaFinAlegacion titulo="Fecha Fin de Alegación" ayuda="Info. Aquí se introduce la fecha limite para aceptar acorde con el acceso a la sede." (popover) {
			Form frmFinAlegacion redirigir=DatosTramites {
				Grupo borde=false{
						Fecha titulo="Fecha Fin de Alegación" campo=SolicitudGenerica.fechaFinDeAlegacion requerido
				}
				Boton btnGuardarFechaFinAlegacion titulo="Guardar"
			}
		}
	} 
	
	
	// Sobreescrito
	Pagina DocumentosFAP titulo="Nuevo Documento" campo=SolicitudGenerica.documentacion.documentos permiso=editarSolicitud perteneceA ="Documentacion"{
		Accion crear redirigir=DocumentacionFAP	
		Grupo gSubirDocumento titulo="Adjuntar Documento"{
			SubirArchivo fileAportacion campo=Documento requerido aportadoPor="CIUDADANO" extensiones="pdf", "png" listarDocumentosSubidos
		}
	}
	
	//Sobreescrito
	Popup DocumentosEditarFAP titulo="Documento" campo=SolicitudGenerica.documentacion.documentos permiso=editarSolicitud{
		Accion editar redirigir=DocumentacionFAP	
		EditarArchivo fileAportacion campo=Documento requerido aportadoPor="CIUDADANO"
	}
	
	// Página Sobreescrita
	Pagina DocumentosExternosFAP titulo="Nuevo documento ya aportado en la Administración" campo=SolicitudGenerica.documentacion.documentosExternos permiso=editarSolicitud perteneceA ="Documentacion"{
		Accion crear redirigir=DocumentacionFAP
		
		Combo tipoDocumento titulo="Tipo Documento" campo=DocumentoExterno.tipo requerido
		AreaTexto descripcion titulo="Descripción" campo=DocumentoExterno.descripcion
		Texto organo titulo="Órgano" campo=DocumentoExterno.organo requerido
		Texto expediente titulo="Expediente" campo=DocumentoExterno.expediente requerido
		AreaTexto uri titulo="Dirección Electrónica" campo=DocumentoExterno.uri
	}
	
	// Popup Sobrescrito
	Popup DocumentosExternosEditarFAP titulo="Modificar Documento Externo" campo=SolicitudGenerica.documentacion.documentosExternos permiso=editarSolicitud{
		Accion editar redirigir=DocumentacionFAP	

		Combo tipoDocumento titulo="Tipo Documento" campo=DocumentoExterno.tipo requerido
		AreaTexto descripcion titulo="Descripción" campo=DocumentoExterno.descripcion
		Texto organo titulo="Órgano" campo=DocumentoExterno.organo requerido
		Texto expediente titulo="Expediente" campo=DocumentoExterno.expediente requerido
		AreaTexto uri titulo="Dirección Electrónica" campo=DocumentoExterno.uri
	}
	
	Popup DocumentosExternosLeerFAP titulo="Ver Documento Externo" campo=SolicitudGenerica.documentacion.documentosExternos {
		Combo tipoDocumento titulo="Tipo Documento" campo=DocumentoExterno.tipo
		AreaTexto descripcion titulo="Descripción" campo=DocumentoExterno.descripcion
		Texto organo titulo="Órgano" campo=DocumentoExterno.organo
		Texto expediente titulo="Expediente" campo=DocumentoExterno.expediente
		AreaTexto uri titulo="Dirección Electrónica" campo=DocumentoExterno.uri
	}
	
	Pagina Aportacion titulo="Aportación" perteneceA ="Aportacion"{
		
		Enlace titulo="Consultar documentos ya aportados" pagina=AportacionAportados estilo="btn"
		Enlace titulo="Consultar recibos de aportaciones" pagina=AportacionRecibos estilo="btn"
		
		Grupo titulo="Paso 1. Agregar Nuevos Documentos"{
			//Wiki {"A partir de las plantillas que se adjuntan en la convocatoria, y una vez rellenadas correctamente, deberá añadirlas como documentación indicando el tipo de documento correspondiente."}
	
			FirmaMasiva documentos
			    titulo="Documentos nuevos pendientes de aportar" 
			    campo=SolicitudGenerica.aportaciones.actual.documentos
				popupBorrar=PopUpDocProcesos
				popupEditar=PopUpDocProcesos  
				popupLeer=PopUpDocProcesos
				paginaCrear=DocumentosAportacion
			{
				Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
				Columna titulo="Tipo Documento" campo=Documento.tipo
				Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
				Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
				Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
			}
		}
		
		Grupo titulo="Incorporar Documentos sin Registro de Entrada" permiso=adminGestorRevisor {
			Form presentarSinRegistrar redirigir=AportacionRecibos {
				Fecha fechaAportacionSinRegistrar titulo="Fecha Incorporación" campo=SolicitudGenerica.aportaciones.actual.fechaAportacionSinRegistro requerido
				Boton aportarSinRegistrar titulo="Incorporar" waitPopup
			}
		}
		
		Grupo titulo="Paso 1b. Registrar los documentos"{
			Form presentar redirigir=AportacionPresentar permiso=aportacionDocumentos {
				Wiki {"Debe registrar los documentos para que se consideren aportados a la solicitud."}
				Boton botonPresentar titulo="Preparar para registrar"
			}
		}
		
	}
	
	Pagina DocumentosAportacion titulo="Aportar Nuevo Documento" campo=SolicitudGenerica.aportaciones.actual.documentos perteneceA ="Aportacion"{
		Accion crear redirigir=Aportacion
		Grupo gSubirDocumento titulo="Aportar Documento"{
			SubirArchivo fileAportacion campo=Documento requerido aportadoPor="CIUDADANO" listarDocumentosSubidos
		}
	}
	
	Pagina AportacionAportados titulo="Documentos Aportados" perteneceA ="Aportacion"{		
		Tabla documentos titulo="Documentos Presentados" 
		    campo=SolicitudGenerica.documentacion.documentos
			popupLeer=PopUpDocPresentados
		{
			Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80" 
			Columna titulo="Tipo Documento" campo=Documento.tipo
			Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
			Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
			Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
		}

		Grupo documentosExternos borde=false mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.documentacion.documentosExternos\")"{
			Tabla documentosExternos titulo="Documentos Externos" campo=SolicitudGenerica.documentacion.documentosExternos popupLeer=DocumentosExternosLeerFAP {
				Columna titulo="Id" campo=DocumentoExterno.id
				Columna titulo="Tipo Documento" campo=DocumentoExterno.tipo
				Columna titulo="Descripcion" campo=DocumentoExterno.descripcionVisible expandir
			}
		}
		
		Enlace titulo="Volver" pagina=Aportacion estilo="btn"
	}	
	
	Pagina AportacionRecibos titulo="Recibos de Aportaciones" noForm  perteneceA ="Aportacion"{
			
		Tabla recibosAportados titulo="Recibos de las aportaciones" campo=SolicitudGenerica.documentacionAportada.documentos permisoFilas=aportacionNoNull
		popupLeer=PopUpAportaciones
		{
			Columna campo=Documento.fechaSubida titulo="Fecha Subida" ancho="80"
			Columna campo=Documento.fechaRegistro titulo="Fecha Registro" ancho="80"
			Columna titulo="Tipo Documento" campo=Documento.tipo ancho="80"
			Columna campo=Documento.descripcionVisible titulo="Descripción" ancho="80"
			Columna campo=Documento.uri titulo="Uri" ancho="80"
			Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
			Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" expandir
		}
		
		Enlace titulo="Volver" pagina=Aportacion estilo="btn"
	}
	
	Popup PopUpAportaciones titulo="Detalle Aportación" campo=SolicitudGenerica.documentacionAportada.documentos {
		Fecha campo=Documento.fechaSubida titulo="Fecha Subida"
		Fecha campo=Documento.fechaRegistro titulo="Fecha Registro"
		Combo campo=Documento.tipo titulo="Tipo Documento"
		Texto campo=Documento.uri titulo="Uri"
		Texto campo=Documento.hash  titulo="Hash"
		Texto campo=Documento.descripcionVisible titulo="Descripción" 
		Enlace campo=Documento.urlDescarga titulo="Descargar"
		Enlace campo=Documento.enlaceDescargaFirmado titulo="Descargar Firmado" 
	}
	
	Popup PopUpDocPresentados titulo="Documentación" campo=SolicitudGenerica.documentacion.documentos{
		EditarArchivo documentoPresentado campo=Documento requerido
	}
	
	Popup PopUpDocProcesos titulo="Documentación" campo=SolicitudGenerica.aportaciones.actual.documentos{
		EditarArchivo documentoProceso campo=Documento requerido
	}
	
	Popup PopUpDocAportados titulo="Documentación" campo=SolicitudGenerica.documentacionAportada.documentos {
		EditarArchivo documentoAportado campo=Documento requerido
	}
		
	// Sobreescrita
	Pagina AportacionPresentar titulo="Presentar la Aportación" noForm perteneceA ="Aportacion"{
	  	Grupo titulo="Presentar Aportación de Documentos" {
			Wiki {"Puede obtener un borrador de la solicitud de aportación de documentación, no válido para su presentación y comprobar que la información introducida es correcta."}

			Enlace campo=SolicitudGenerica.aportaciones.actual.registro.borrador.urlDescarga titulo="Obtener borrador" destino="_blank" estilo="btn"
		
			Form modificarBorrador redirigir=Aportacion permiso=aportacionModificar{
				Wiki {"Puede realizar cambios antes de su presentación definitiva."}
				Boton botonModificarBorrador titulo="Modificar datos"
			}
			
			Tabla documentos 
		    	titulo="Documentos aportados que se van a registrar" 
		    	campo=SolicitudGenerica.aportaciones.actual.documentos
				popupLeer=PopUpDocProcesos
			{
				Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
				Columna campo=Documento.fechaRegistro titulo="Fecha Registro" ancho="80"
				Columna titulo="Tipo Documento" campo=Documento.tipo
				Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
				Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
				Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
			}
			
//			Grupo mensajeIntermedio permiso=aportacionMensajeIntermedio borde=false {
//				Wiki estilo ="box-warn box" {
//					"Se produjo un error en la presentación de la aportación. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
//				}
//			}
			
			// Sobreescrito HTML
			
			Grupo borde=false mostrarSiCampo SolicitudGenerica.activoFH="true"{
				Grupo titulo="Firma Requerida a Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=habilitarFHAportacion{
					Form formHabilitarFH {
						Boton btnHabilitarFH titulo="Habilitar a los Funcionarios para firmar en mi nombre"
					}
					Grupo borde=false mostrarSiCampo SolicitudGenerica.registro.habilitaFuncionario="true"{
						Wiki{"Ya ha sido habilitada la opción de que un funcionario habilitado pueda firmar y registrar."}
					}
				}
			}
			
			//Firma Funcionario Habilitado
			Grupo borde=false mostrarSiCampo SolicitudGenerica.aportaciones.actual.habilitaFuncionario="true"{
				Grupo titulo="Paso 2. Presentar los Documentos por Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=firmarRegistrarAportacionFH
				{
					Wiki{"**NOTA: Debe finalizar el Paso 2 pulsando en el botón 'Firmar y presentar' para que los Nuevos Documentos se consideren presentados. Cuando el proceso finalice los documentos nuevos desaparecerán del Paso 1 y se incorporarán a la lista de Documentos Presentados.**"}
					Wiki{"La solicitud será firmada y registrada. Puede obtener un recibo de la presentación de la solicitud una vez 'Firmar y Presentar' se haya realizado con éxito"}
					Form formFirmaFH { 
						FirmaSimple firmarRegistrarFH titulo="Firmar y presentar por Funcionario Habilitado" 
							documento=SolicitudGenerica.aportaciones.actual.registro.oficial
							listaFirmantes=SolicitudGenerica.registro.firmantes.todos
							calcularFirmantes=SolicitudGenerica.solicitante
					}
				}
			}
			
			Grupo titulo="Paso 2. Presentar los Documentos"{
				Wiki{"**NOTA: Debe finalizar el Paso 2 pulsando en el botón 'Firmar y presentar' para que los Nuevos Documentos se consideren presentados. Cuando el proceso finalice los documentos nuevos desaparecerán del Paso 1 y se incorporarán a la lista de Documentos Presentados.**"}
				Wiki{"La solicitud será firmada y registrada. Puede obtener un recibo de la presentación de la solicitud una vez 'Firmar y Presentar' se haya realizado con éxito"}
				Form presentar redirigir=AportacionRecibos {
					FirmaSimple firmarRepresentante titulo="Firmar y presentar"
						documento=SolicitudGenerica.aportaciones.actual.registro.oficial
						listaFirmantes=SolicitudGenerica.registro.firmantes.todos
						calcularFirmantes=SolicitudGenerica.solicitante
				}
			}
				

			

			Wiki {"Nota: La operación de firmar y presentar puede tardar varios minutos."}
		}
	}
	
	
	// ******************************************************************************************
	// VERIFICACION DE DATOS
	// *******************************************************************************************
	Pagina VerificacionDatos titulo="Verificación de datos" noForm perteneceA="Verificacion" campo=SolicitudGenerica permiso=adminOrGestor{
		Wiki {"En esta página se procederá a la verificación de Datos del usuario siempre y cuando el usuario haya consentido
				el acceso a la base de datos."}
		
		Grupo sinPermiso titulo="Crear una nueva verificación de datos" permiso=noHayverificacion mostrarSiCampo SolicitudGenerica.cesion.autorizacionCesion.identidad="false"{
				Wiki{"El usuario no ha consentido el acceso a su base de datos."}
			}
		Grupo VerificaDatos titulo="Crear una nueva verificación de datos" permiso=noHayverificacion mostrarSiCampo SolicitudGenerica.cesion.autorizacionCesion.identidad="true"{
			Form verificacionNueva {
				Texto campo=SolicitudGenerica.peticion.uidUsuario titulo="Usuario" requerido
				Texto campo=SolicitudGenerica.peticion.codigoCertificado titulo="Código de Certificado" requerido
				Wiki {"¡ATENCIÓN!: Recuerda que solo se verifican los datos de la última solicitud añadida,es decir,la más reciente"}
				Tabla solicitudesPeticion titulo="Solicitudes" campo=SolicitudGenerica.peticion.solicitudTransmision
				paginaCrear=EditarSolicitudTransmision paginaEditar=EditarSolicitudTransmision paginaBorrar=BorrarSolicitudTransmision recargarPagina
				{
					Columna campo=SolicitudTransmision.datosGenericos.solicitante.identificadorSolicitante titulo="CIF Solicitante" ancho="100"
					Columna campo=SolicitudTransmision.datosGenericos.solicitante.nombreSolicitante titulo="Nombre Organismo" ancho="150"
					Columna campo=SolicitudTransmision.datosGenericos.solicitante.unidadTramitadora titulo="UnidadTramitadora" ancho="150"
					Columna campo=SolicitudTransmision.datosGenericos.solicitante.procedimiento.codigoProcedimiento titulo="Código Procedimiento" ancho="150"
					Columna campo=SolicitudTransmision.datosGenericos.solicitante.funcionario.nombreCompletoFuncionario titulo="Nombre Funcionario" ancho="150"
					Columna campo=SolicitudTransmision.datosGenericos.solicitante.funcionario.nifFuncionario titulo="NIF Funcionario" ancho="150"
					Columna campo=SolicitudTransmision.datosGenericos.titular.documentacion titulo="Nº Documento" ancho="150"
				}
				Wiki {"Pulse el botón para verificar los datos del solicitante."}
				Boton botonIniciarVerificacionDatos titulo="Verificar Datos" waitPopup 
			}
		}
	}
	
	Pagina BorrarSolicitudTransmision titulo="Ver Verificación" campo=SolicitudGenerica.peticion.solicitudTransmision permiso=adminOrGestor {
		Accion borrar redirigir=VerificacionDatos
		Grupo datosSolicitudTransmision titulo="Datos generales de la Solicitud" {
			Grupo datosSolicitante titulo="Datos del solicitante"{
				Texto titulo="CIF Solicitante" campo=SolicitudTransmision.datosGenericos.solicitante.identificadorSolicitante requerido
				Texto titulo="Nombre Organismo" campo=SolicitudTransmision.datosGenericos.solicitante.nombreSolicitante requerido
				Texto titulo="Finalidad" campo=SolicitudTransmision.datosGenericos.solicitante.finalidad requerido
				Texto titulo="Unidad Tramitadora" campo=SolicitudTransmision.datosGenericos.solicitante.unidadTramitadora requerido
				Texto titulo="ID Expediente" campo=SolicitudTransmision.datosGenericos.solicitante.idExpediente
				Grupo datosProcedimiento titulo="Datos del procedimiento"{
					Texto titulo="Código Procedimiento" campo=SolicitudTransmision.datosGenericos.solicitante.procedimiento.codigoProcedimiento requerido
					Texto titulo="Nombre Procedimiento" campo=SolicitudTransmision.datosGenericos.solicitante.procedimiento.nombreProcedimiento requerido
				}
				Grupo datosFuncionario titulo="Datos del funcionario"{
					Texto titulo="Nombre funcionario" campo=SolicitudTransmision.datosGenericos.solicitante.funcionario.nombreCompletoFuncionario requerido
					Texto titulo="NIF funcionario" campo=SolicitudTransmision.datosGenericos.solicitante.funcionario.nifFuncionario requerido
				}
				Grupo consentimiento titulo="Consentimiento"{
					Combo titulo="Tipo de consentimiento" campo=SolicitudTransmision.datosGenericos.solicitante.consentimiento requerido
				}	
			}
			Grupo datosTitular titulo="Datos del titular"{
				Combo titulo="Tipo Documento" campo=SolicitudTransmision.datosGenericos.titular.tipoDocumentacion requerido
				Texto titulo="Nº Documento" campo=SolicitudTransmision.datosGenericos.titular.documentacion requerido
				//Texto titulo="Nombre Completo" campo=SolicitudTransmision.datosGenericos.titular.nombreCompleto 
				Texto titulo="Nombre" campo=SolicitudTransmision.datosGenericos.titular.nombre
				Texto titulo="Apellido 1" campo=SolicitudTransmision.datosGenericos.titular.apellido1
				Texto titulo="Apellido 2" campo=SolicitudTransmision.datosGenericos.titular.apellido2	
			}
		}
		Enlace volverVerificacionDatos titulo="Volver" pagina=VerificacionDatos estilo="btn"	
	}
	
	Pagina EditarSolicitudTransmision titulo="Ver Verificación" campo=SolicitudGenerica.peticion.solicitudTransmision permiso=adminOrGestor {
		Grupo datosSolicitudTransmision titulo="Datos generales de la Solicitud" {
			Grupo datosSolicitante titulo="Datos del solicitante"{
				Texto titulo="CIF Solicitante" campo=SolicitudTransmision.datosGenericos.solicitante.identificadorSolicitante requerido
				Texto titulo="Nombre Organismo" campo=SolicitudTransmision.datosGenericos.solicitante.nombreSolicitante requerido
				Texto titulo="Finalidad" campo=SolicitudTransmision.datosGenericos.solicitante.finalidad requerido
				Texto titulo="Unidad Tramitadora" campo=SolicitudTransmision.datosGenericos.solicitante.unidadTramitadora requerido
				Texto titulo="ID Expediente" campo=SolicitudTransmision.datosGenericos.solicitante.idExpediente
				Grupo datosProcedimiento titulo="Datos del procedimiento"{
					Texto titulo="Código Procedimiento" campo=SolicitudTransmision.datosGenericos.solicitante.procedimiento.codigoProcedimiento requerido
					Texto titulo="Nombre Procedimiento" campo=SolicitudTransmision.datosGenericos.solicitante.procedimiento.nombreProcedimiento requerido
				}
				Grupo datosFuncionario titulo="Datos del funcionario"{
					Texto titulo="Nombre funcionario" campo=SolicitudTransmision.datosGenericos.solicitante.funcionario.nombreCompletoFuncionario requerido
					Texto titulo="NIF funcionario" campo=SolicitudTransmision.datosGenericos.solicitante.funcionario.nifFuncionario requerido
				}
				Grupo consentimiento titulo="Consentimiento"{
					Combo titulo="Tipo de consentimiento" campo=SolicitudTransmision.datosGenericos.solicitante.consentimiento requerido
				}	
			}
			Grupo datosTitular titulo="Datos del titular"{
				Combo titulo="Tipo Documento" campo=SolicitudTransmision.datosGenericos.titular.tipoDocumentacion requerido
				Texto titulo="Nº Documento" campo=SolicitudTransmision.datosGenericos.titular.documentacion requerido
				//Texto titulo="Nombre Completo" campo=SolicitudTransmision.datosGenericos.titular.nombreCompleto 
				Texto titulo="Nombre" campo=SolicitudTransmision.datosGenericos.titular.nombre
				Texto titulo="Apellido 1" campo=SolicitudTransmision.datosGenericos.titular.apellido1
				Texto titulo="Apellido 2" campo=SolicitudTransmision.datosGenericos.titular.apellido2	
			}
		}
		Enlace volverVerificacionDatos titulo="Volver" pagina=VerificacionDatos estilo="btn" 	
	}
	
	//SOBREESCRITA (HTML)
	Pagina DatosVerificados titulo= "Resultado de Verificación de datos" noForm perteneceA="Verificacion" campo=SolicitudGenerica permiso=adminOrGestor{
		Texto campo=SolicitudGenerica.respuestaSvd.atributos.codigoCertificado titulo="codigo certificado"
	}
	
		
	// ******************************************************************************************
	// VERIFICACION
	// *******************************************************************************************
	
	Pagina AccesoVerificaciones titulo="Verificaciones" noForm  perteneceA ="Verificacion"{
		Tabla verificaciones titulo="Verificaciones" campo=SolicitudGenerica.verificaciones
			paginaEditar=PaginaVerificacionesAnteriores
		{
				Columna titulo="Expediente" campo=Verificacion.expediente ancho="150"
				Columna titulo="Motivo Exclusión" campo=Verificacion.requerimiento.motivo ancho="150" 
				Columna titulo="Fecha creación" campo=Verificacion.fechaCreacion ancho="150"
				Columna titulo="Fecha finalización" campo=Verificacion.fechaUltimaActualizacion ancho="150"
				Columna titulo="Estado" campo=Verificacion.estado expandir
		}
		Grupo gVerificacionNueva titulo="Crear una nueva verificación" permiso=noHayverificacion{
			Form verificacionNueva {
				Wiki {"Pulse el botón para crear una nueva verificación."}
				Boton botonIniciarVerificacion titulo="Nueva verificación"
			}
		}
		Grupo gVerificacionActual titulo="Acceder a la verificacion actual" permiso=hayverificacion {
			Form verificacionActual {
				Wiki {"Pulse el botón para acceder a la verificación que está actualmente en curso."}
				Boton botonIraVerificacion titulo="Ir a verificación" pagina=PaginaVerificacion
			}
		}
	}
	
	Pagina PaginaVerificacionesAnteriores titulo="Ver Verificación" campo=SolicitudGenerica.verificaciones noForm perteneceA ="Verificacion"{

		Grupo noEditable borde=false permiso=noEditable{
			Grupo datosVerificacion titulo="Datos generales de la verificación" {
				Texto expediente titulo="Expediente" campo=Verificacion.expediente
				Combo estadoS titulo="Estado Solicitud" campo=SolicitudGenerica.estadoValue
				Texto motivoReq titulo="Motivo Requerimiento" campo=Verificacion.requerimiento.motivo
				Fecha fechaCreacion titulo="Fecha Creación" campo=Verificacion.fechaCreacion
				Fecha fechaActualizacion titulo="Fecha Actualizacion" campo=Verificacion.fechaUltimaActualizacion
				Combo estadoV titulo="Estado Verificación" campo=Verificacion.estado
			}
			
			Tabla verificacionDocumentos titulo="Documentación" campo=Verificacion.documentos
				paginaEditar=PaginaDocumentoVerificacionLeerAnteriores
			{
				Columna titulo="Fecha Presentación" campo=VerificacionDocumento.fechaPresentacion ancho="80"
				Columna titulo="Descripción" campo=VerificacionDocumento.descripcion expandir
				Columna titulo="Tipo documento" campo=VerificacionDocumento.nombreTipoDocumento
				Columna titulo="Estado" campo=VerificacionDocumento.estadoDocumentoVerificacion ancho="100"
				Columna titulo="Multiplicidad" campo=VerificacionDocumento.identificadorMultiple ancho="80"
				Columna campo=VerificacionDocumento.linkUrlDescarga titulo="Descargar" ancho="100"	
			}
			
			AreaTexto motivoGeneralRequerimiento titulo="Motivo General de Requerimiento" campo=SolicitudGenerica.verificacion.requerimiento.motivo ancho="500px"
					
		}
		
		Grupo gDocumentoRequerimiento  permiso=obtenerRequerimiento borde=false {
			Enlace campo=Verificacion.requerimiento.justificante.urlDescarga titulo="Obtener requerimiento"  destino="_blank" estilo="btn"
		}
		
		Enlace volverVerificacionAnteriores titulo="Volver" pagina=AccesoVerificaciones estilo="btn"
	}
	
	Pagina PaginaDocumentoVerificacionLeerAnteriores titulo="Documento Verificado" campo=SolicitudGenerica.verificaciones.documentos noForm perteneceA ="Verificacion"{
		Grupo noEditable borde=false permiso=noEditable{
			Grupo botonDescarga borde=false mostrarSiExpresion "verificacionDocumento.uriDocumento != null"{
				Enlace campo=VerificacionDocumento.urlDescarga titulo="Descargar" destino="_blank" estilo="boton"
			}
			Texto titulo="Descripción" campo=VerificacionDocumento.descripcion ancho="420px"
			Texto tipo titulo="Tipo documento" campo=VerificacionDocumento.nombreTipoDocumento ancho="420px"
			Texto tipoUri titulo="Uri tipo documento" campo=VerificacionDocumento.uriTipoDocumento ancho="420px"
			Fecha fechaPresentacion titulo="Fecha de presentación" campo=VerificacionDocumento.fechaPresentacion
			Combo estado titulo="Estado" campo=VerificacionDocumento.estadoDocumentoVerificacion
			Grupo requerimientosNoValido titulo="Requerimiento/s del documento" mostrarSiCombo estado="noValido","noPresentado"{
				Grupo requerimientoTexto borde=false mostrarSiCombo estado="noValido","noPresentado"{
					AreaTexto requerimientoTexto titulo="Motivo requerimiento" campo=VerificacionDocumento.motivoRequerimiento ancho="450px"
				}
				Grupo requerimientoCodigos borde=false mostrarSiCombo estado="noValido" {
					Tabla requerimientosDocumento titulo="Requerimientos" campo=VerificacionDocumento.codigosRequerimiento
						popupLeer=PopUpDocumentoRequerimientosVerificacion
					{
						Columna titulo="Código" campo=CodigoRequerimiento.codigo ancho="150"
						Columna titulo="Descripción" campo=CodigoRequerimiento.descripcionCorta expandir
					}
				}
			}
		}
		
		Enlace volverVerificacionActual titulo="Volver" anterior estilo="btn"
	}
	
	Pagina PaginaVerificacion titulo="Verificación" campo=SolicitudGenerica.verificacion noForm permiso=accederSiSolicituNoBorrador perteneceA ="Verificacion"{
		
		Grupo gAnularVerificacion titulo="Anular Verificación" permiso=anularVerificacion{
			Wiki {"Presione el Botón de Anular Verificación bajo su propia responsabilidad."}
			Form anularVerificacion {
				Boton botonAnularVerificacion titulo="Anular la Verificación" type=danger
			}
		}

		Grupo gModificarVerificacion titulo="Modificar la verificación" permiso=modificarRequerimiento{
			Wiki {"Puede modificar la verificación si necesita cambiar el motivo de requerimiento o el gestor que debe firmar"}
			Form reabrirVerificacion permiso=modificarRequerimiento {
				Boton botonReabrirVerificacion titulo="Modificar la Verificación" type=warning
            }
		}
		
		Grupo datosVerificacion titulo="Datos generales de la verificación" permiso=noEditable{
			Texto expediente titulo="Expediente" campo=Verificacion.expediente
			Combo estadoS titulo="Estado Solicitud" campo=SolicitudGenerica.estadoValue
			Texto motivoReq titulo="Motivo Requerimiento" campo=Verificacion.requerimiento.motivo
			Fecha fechaCreacion titulo="Fecha Creación" campo=Verificacion.fechaCreacion
			Fecha fechaActualizacion titulo="Fecha Actualizacion" campo=Verificacion.fechaUltimaActualizacion
			Combo estadoV titulo="Estado Verificación" campo=Verificacion.estado
		}
		
		Grupo giniciarVerificacion titulo="Iniciar la verificación" permiso=iniciarVerificacion {
			Form iniciarVerificacion {
				Combo getTramitesCombo titulo="Seleccione el trámite" campo=Verificacion.uriTramite requerido
				Wiki {"Si la solicitud está lista para iniciar la verificación, pulse el siguiente botón."}
				Boton botonIniciarVerificacion titulo="Iniciar la verificación"
			}
		}
		
		Form nuevosDocumentos permiso=hayNuevaDocumentacionVerificacion{
			Wiki{"Existen nuevos documentos aportados por el solicitante y que no están incluídos en la verificación actual.
				  Por favor, pulse el siguiente botón para añadirlos a la verificación que está actualmente en curso."}
			Boton adjuntarNuevosDocumentos titulo="Añadir nuevos documentos"
		}

		Grupo tiposProceso titulo="Verificación de Tipos de Documentos" permiso=verificarTiposDocumentos {
			Tabla verificacionTipos titulo="Documentación Aún No Verificada" campo=SolicitudGenerica.documentacion.documentos
				popupEditar=PopUpDocTipos popupLeer=PopUpDocTipos {
				Columna campo=Documento.fechaSubida titulo="Fecha de Subida" ancho="100"
				Columna campo=Documento.fechaRegistro titulo="Fecha de Registro" ancho="100"
				Columna titulo="Tipo Documento" campo=Documento.tipo
				Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
				Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
				Columna campo=Documento.enlaceDescargaFirmado titulo="Descargar Firmado" ancho="110"
				
			}
			Form verificaTipos {
				Boton finalizaVerificarTipos titulo="Finaliza verificación de tipos"
			}
		}
		
		Grupo verificacionProceso titulo="Verificación de la documentación" permiso=verificarDocumentos { 
		
			Grupo botonDescargaReciboSolitud borde=false{
				Enlace campo=SolicitudGenerica.registro.justificante.urlDescarga titulo="Descargar Recibo Solicitud" destino="_blank" estilo="btn"
			}	
			
			Wiki { "<br/> " }
			
			Grupo titulo="Presentación de modificaciones"  mostrarSiExpresion "!solicitud.registroModificacion.isEmpty()" {
				Tabla tablaModificaciones campo=SolicitudGenerica.registroModificacion titulo="Modificaciones Presentadas" recargarPagina {
					Columna campo=RegistroModificacion.fechaCreacion titulo="Fecha Creación" expandir
					Columna campo=RegistroModificacion.fechaLimite titulo="Fecha Límite" expandir
					Columna campo=RegistroModificacion.fechaRegistro titulo="Fecha Registro" expandir
					Columna campo=RegistroModificacion.estado titulo="Estado" expandir
					Columna campo=RegistroModificacion.registro.justificante.enlaceDescarga titulo="Justificante" expandir
				}
			}
			
			Wiki { "<br/> " }
			
			Form frmtiposProceso permiso=verificarObtenerNoProcede {
				Grupo noProcedeAnteriores titulo="Obtener los documentos No Procede de verificaciones anteriores"{
					Boton obtenerNoProcede titulo="Obtener los NoProcede" type=warning
				}
			}	
			
			Form incluirNoProcedeMultiples {
				Grupo GrupoMultiples titulo = "Añadir tipo de documento a la verificacion"{
					Combo comboMultiples titulo="Tipos de Documentos" campo=SolicitudGenerica.verificacion.incluirFichMultiple requerido//sobreescribir que muestre descripcion
					Boton incluirNoProcede titulo="Añadir"
				}
			}
			
				Tabla verificacionDocumentos titulo="Documentación" campo=SolicitudGenerica.verificacion.documentos
					paginaLeer=PaginaDocumentoVerificacionLeer 
					paginaEditar=PaginaDocumentoVerificacionEditar 
				{
					//Columna titulo="Id" campo=VerificacionDocumento.id ancho="40"
					Columna titulo="Fecha Presentación" campo=VerificacionDocumento.fechaPresentacion ancho="80"
					Columna titulo="Descripción" campo=VerificacionDocumento.descripcion expandir
					Columna titulo="Tipo documento" campo=VerificacionDocumento.nombreTipoDocumento
					Columna titulo="Estado" campo=VerificacionDocumento.estadoDocumentoVerificacion ancho="100"
					Columna titulo="Multiplicidad" campo=VerificacionDocumento.identificadorMultiple ancho="80"
					Columna campo=VerificacionDocumento.linkUrlDescarga titulo="Descargar" ancho="100"	
				}
				
				Form guardarMotivoRequerimientoGeneral {
					AreaTexto motivoGeneralRequerimiento titulo="Motivo General de Requerimiento" campo=SolicitudGenerica.verificacion.requerimiento.motivo ancho="500px"
					Combo gestorAFirmar titulo="Persona que debe firmar" campo=SolicitudGenerica.verificacion.requerimiento.firmante ancho="450px" 
					Boton guardarRequerimientoMotivoRequerimientoGeneralbtn titulo="Guardar Requerimiento"
				    Boton btnFinalizarVerificacion titulo="Finalizar Verificación"
				}		
			
				Form gnuevoRequerimientoBorradorPreliminar permiso=obtenerBorradorRequerimiento destino="_blank"{ 
					Boton obtenerBorradorPreliminar titulo="Obtener Borrador Requerimiento"
				}
				
//				Form finalizarVerificacion {
//					Boton btnFinalizarVerificacionb titulo="Finalizar Verificación"
//				}
			
		}
		
		Grupo gRequerimientos permiso=requerimiento borde = false{
		
		    Grupo gDatosVerificacionDocumentos titulo = "Verificación de la Documentación"{
		    	
				Grupo botonDescargaReciboSolitudgR borde=false{
					Enlace campo=SolicitudGenerica.registro.justificante.urlDescarga titulo="Descargar Recibo Solicitud" destino="_blank" estilo="btn"
				}	
				
				Wiki { "<br/> " }
				
				Grupo grupoModificacionesRequerimiento titulo="Presentación de modificaciones"  mostrarSiExpresion "!solicitud.registroModificacion.isEmpty()" {
					Tabla tablaModificacionesRequerimiento campo=SolicitudGenerica.registroModificacion titulo="Modificaciones Presentadas" recargarPagina {
						Columna campo=RegistroModificacion.fechaCreacion titulo="Fecha Creación" expandir
						Columna campo=RegistroModificacion.fechaLimite titulo="Fecha Límite" expandir
						Columna campo=RegistroModificacion.fechaRegistro titulo="Fecha Registro" expandir
						Columna campo=RegistroModificacion.estado titulo="Estado" expandir
						Columna campo=RegistroModificacion.registro.justificante.enlaceDescarga titulo="Justificante" expandir
					}
				}
				
				Wiki { "<br/> " }
				
				Tabla verificacionDocumentosgR titulo="Documentación" campo=SolicitudGenerica.verificacion.documentos
					paginaLeer=PaginaDocumentoVerificacionLeer 
				{
					//Columna titulo="Id" campo=VerificacionDocumento.id ancho="40"
					Columna titulo="Fecha Presentación" campo=VerificacionDocumento.fechaPresentacion ancho="80"
					Columna titulo="Descripción" campo=VerificacionDocumento.descripcion expandir
					Columna titulo="Tipo documento" campo=VerificacionDocumento.nombreTipoDocumento
					Columna titulo="Estado" campo=VerificacionDocumento.estadoDocumentoVerificacion ancho="100"
					Columna titulo="Multiplicidad" campo=VerificacionDocumento.identificadorMultiple ancho="80"
					Columna campo=VerificacionDocumento.linkUrlDescarga titulo="Descargar" ancho="100"	
				}
			
				Form gnuevoRequerimientoBorradorPreliminargR permiso=obtenerBorradorRequerimiento destino="_blank"{ 
					Boton obtenerBorradorPreliminar titulo="Obtener Borrador Requerimiento"
				}
			}
			
			Grupo gRequerimientoFirmaYPonerADisposicion titulo="Requerimiento" {
			
				Form gRequerirFirmaRequerimiento permiso=requerimientoRequerirFirma {
					Boton requerirFirma titulo="Requerir firma al Gestor" 
				} 
				
				Form gFirmarRequerimiento permiso=requerimientoAFirmar {
					FirmaSimple firmaRequerimiento titulo="Firmar y Registrar de salida el Requerimiento" documento=SolicitudGenerica.verificacion.requerimiento.oficial listaFirmantes=SolicitudGenerica.verificacion.requerimiento.registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante  
				}
				
				Form gPonerADisposicion permiso=requerimientoFirmado {
					Enlace campo=SolicitudGenerica.verificacion.requerimiento.justificante.urlDescarga titulo="Descargar Justificante a Notificar" destino="_blank" estilo="btn"
					Boton ponerADisposicion titulo="Notificar el requerimiento" waitPopup
				}
				
				Form gDescargarNotificacionRequerimiento permiso=requerimientoEnviado {
				    Enlace campo=SolicitudGenerica.verificacion.requerimiento.justificante.urlDescarga titulo="Obtener Requerimiento" destino="_blank" estilo="btn"
				}
			}
			
		}
		Grupo nuevosDocumentosTipos titulo="Verificación de Tipos de Documentos" permiso=verificacionConNuevosDoc {
			Tabla verificacionTiposNuevosDoc titulo="Documentación Aún No Verificada" campo=SolicitudGenerica.verificacion.nuevosDocumentos
				popupEditar=PopUpDocNuevosTipos popupLeer=PopUpDocNuevosTipos {
				Columna campo=Documento.fechaSubida titulo="Fecha de Subida" ancho="100"
				Columna campo=Documento.fechaRegistro titulo="Fecha de Registro" ancho="100"
				Columna titulo="Tipo Documento" campo=Documento.tipo
				Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
				Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
				Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
			}
			Form verificaTiposNuevosDoc {
				Boton finalizaVerificarTipos titulo="Finaliza verificación de tipos"
			}
		}
		
		Enlace volverVerificaciones titulo="Volver" pagina=AccesoVerificaciones estilo="btn"
	}
	
	
	Pagina ListaDocumentosExpedienteFAP titulo="Lista de documentos del expediente"	permiso=adminOrGestor campo=SolicitudGenerica  noForm {
		
		Tabla documentosExpediente titulo="Documentos del Expediente" campo=SolicitudGenerica.documentacion.documentos {
			Columna titulo="Tipo" campo=Documento.tipo ancho="100"
			Columna titulo="Uri" campo=Documento.uri  expandir
			Columna titulo="Descripción" campo=Documento.descripcion expandir
			Columna titulo="Subido" campo=Documento.fechaSubida ancho="80" align=right
			Columna titulo="Descargar" campo=Documento.enlaceDescarga ancho="80"
		}

	}
	
	Popup PopUpDocTipos titulo="Documentación" campo=SolicitudGenerica.documentacion.documentos {
		EditarArchivo documentoProceso campo=Documento requerido
	}
	
	Popup PopUpDocNuevosTipos titulo="Documentación" campo=SolicitudGenerica.verificacion.nuevosDocumentos {
		EditarArchivo documentoProceso campo=Documento requerido
	}
	
	Pagina PaginaDocumentoVerificacionLeer titulo="Ver Documento de la Verificación" campo=SolicitudGenerica.verificacion.documentos perteneceA ="Verificacion"{
		Grupo botonDescarga borde=false mostrarSiExpresion "verificacionDocumento.uriDocumento != null"{
			Enlace campo=VerificacionDocumento.urlDescarga titulo="Descargar" destino="_blank" estilo="boton"
		}
		Texto titulo="Descripción" campo=VerificacionDocumento.descripcion ancho="420px"
		Texto tipo titulo="Tipo documento" campo=VerificacionDocumento.nombreTipoDocumento ancho="420px"
		Texto tipoUri titulo="Uri tipo documento" campo=VerificacionDocumento.uriTipoDocumento ancho="420px"
		Fecha fechaPresentacion titulo="Fecha de presentación" campo=VerificacionDocumento.fechaPresentacion
		Combo estado titulo="Estado" campo=VerificacionDocumento.estadoDocumentoVerificacion
		Grupo requerimientosNoValido titulo="Requerimiento/s del documento" mostrarSiCombo estado="noValido","noPresentado"{
			Grupo requerimientoTexto borde=false mostrarSiCombo estado="noValido","noPresentado"{
				AreaTexto requerimientoTexto titulo="Motivo requerimiento" campo=VerificacionDocumento.motivoRequerimiento ancho="450px"
			}
			Grupo requerimientoCodigos borde=false mostrarSiCombo estado="noValido" {
				Tabla requerimientosDocumento titulo="Requerimientos" campo=VerificacionDocumento.codigosRequerimiento
					popupLeer=PopUpDocumentoRequerimientosVerificacion
				{
					Columna titulo="Código" campo=CodigoRequerimiento.codigo ancho="150"
					Columna titulo="Descripción" campo=CodigoRequerimiento.descripcionCorta expandir
				}
			}
		}
		Enlace volverVerificacionActual titulo="Volver" pagina=PaginaVerificacion estilo="btn"
	}
	
	Pagina PaginaDocumentoVerificacionEditar titulo="Editar Documento" campo=SolicitudGenerica.verificacion.documentos perteneceA ="Verificacion"{
		Accion editar redirigir=PaginaVerificacion
		Grupo botonDescarga borde=false mostrarSiExpresion "verificacionDocumento.uriDocumento != null"{
			Enlace campo=VerificacionDocumento.urlDescarga titulo="Descargar" destino="_blank" estilo="boton"
		}
		Grupo noEditable permiso=noEditable borde=false{
			Texto titulo="Descripción" campo=VerificacionDocumento.descripcion ancho="420px"
			Texto tipo titulo="Tipo documento" campo=VerificacionDocumento.nombreTipoDocumento ancho="420px"
			Texto tipoUri titulo="Uri tipo documento" campo=VerificacionDocumento.uriTipoDocumento ancho="420px"
			Fecha fechaPresentacion titulo="Fecha de presentación" campo=VerificacionDocumento.fechaPresentacion
		}
		Combo estado titulo="Estado" campo=VerificacionDocumento.estadoDocumentoVerificacion requerido
		Grupo requerimientosNoValido titulo="Requerimiento/s del documento" mostrarSiCombo estado="noValido","noPresentado" enviarCamposOcultos=true {
			Grupo requerimientoTexto borde=false mostrarSiCombo estado="noValido","noPresentado" enviarCamposOcultos=true {
				AreaTexto requerimientoTexto titulo="Motivo requerimiento" campo=VerificacionDocumento.motivoRequerimiento ancho="450px"
			}
			Grupo requerimientoCodigos borde=false mostrarSiCombo estado="noValido"  enviarCamposOcultos=true {
				Tabla requerimientosDocumento titulo="Requerimientos" campo=VerificacionDocumento.codigosRequerimiento
					popupCrear=PopUpDocumentoRequerimientosVerificacionEditar
					popupEditar=PopUpDocumentoRequerimientosVerificacionEditar
					popupLeer=PopUpDocumentoRequerimientosVerificacion
					popupBorrar=PopUpDocumentoRequerimientosVerificacion
				{
					Columna titulo="Código" campo=CodigoRequerimiento.codigo ancho="150"
					Columna titulo="Descripción" campo=CodigoRequerimiento.descripcionCorta expandir
				}
			}
		}
		Enlace volverVerificacionActual titulo="Volver" pagina=PaginaVerificacion estilo="btn"
		
	}
	
	Popup PopUpDocumentoRequerimientosVerificacion titulo="Requerimiento" campo=VerificacionDocumento.codigosRequerimiento {
		Texto descripcionCorta titulo="Descripción Corta" campo=CodigoRequerimiento.descripcionCorta requerido
		Texto codigo titulo="Código" campo=CodigoRequerimiento.codigo
		AreaTexto descripcion titulo="Descripción" campo=CodigoRequerimiento.descripcion
	}
	
	Popup PopUpDocumentoRequerimientosVerificacionEditar titulo="Requerimiento" campo=VerificacionDocumento.codigosRequerimiento {
		Combo descripcionCorta titulo="Descripción Corta" campo=CodigoRequerimiento.descripcionCorta requerido
		Grupo descripciones borde=false permiso=noEditable{
			Texto codigo titulo="Código" campo=CodigoRequerimiento.codigo
			AreaTexto descripcion titulo="Descripción" campo=CodigoRequerimiento.descripcion
		}
	}
	
	Pagina Exclusion titulo="Exclusión" noForm permiso=accederSiSolicituNoBorrador  perteneceA ="Exclusion"{
		Tabla exclusion titulo="Codigos de Exclusión" campo=SolicitudGenerica.exclusion.codigos
		popup=PopUpExclusion
		{
			Columna titulo="Código" campo=CodigoExclusion.codigo
			Columna titulo="Descripción corta" campo=CodigoExclusion.tipoCodigo.descripcionCorta expandir
		}
		Form finalizarExclusion {
			Boton finalizarExclusionBoton titulo="Finalizar Exclusión"
		} 
	}
	
	Popup PopUpExclusion campo=SolicitudGenerica.exclusion.codigos titulo="Datos Exclusión" {

		Combo descripcionCorta campo=CodigoExclusion.tipoCodigo.descripcionCorta titulo="Descripción Corta"
		Grupo permiso=noEditable borde=false {
			Texto codigo campo=CodigoExclusion.codigo titulo="Código"
			AreaTexto descripcion campo=CodigoExclusion.tipoCodigo.descripcion titulo="Descripcion" 
		}
	}

	//Sobreescrita
	Pagina PCEconomicos titulo="Conceptos Económicos" permiso=editarSolicitudYIniciarBaremacion guardarParaPreparar{
		Form Guardar {
			Boton botonGuardar titulo="Guardar" 
		}
	}
	
	//Sobreescrita
	Pagina PaginaCEconomicos titulo= "Conceptos Económicos" campo=SolicitudGenerica.ceconomicos permiso=editarSolicitudYIniciarBaremacion noForm  perteneceA ="Baremacion"{
		Form Guardar { 
			Texto Nombre titulo="Nombre" campo=CEconomico.tipo.nombre
			Grupo conceptosManuales borde=false permiso=verTablaCEconomicosOtros {
				Tabla ceconomicosManuales titulo="Especificar Detalle" campo=CEconomico.otros paginaCrear=PaginaCEconomicoManual paginaEditar=PaginaCEconomicoManual paginaLeer=PaginaCEconomicoManual popupBorrar=PopUpCEconomicoManualBorrar recargarPagina{
					Columna campo=CEconomicosManuales.tipo.jerarquia titulo="Jerarquía"
					Columna campo=CEconomicosManuales.tipo.nombre titulo="Nombre" expandir
				}
			}
			Boton botonGuardar titulo="Guardar" 
		}
	}
	
	//Sobreescrita
	Pagina PaginaCEconomicoManual titulo="Concepto Económico" campo=SolicitudGenerica.ceconomicos.otros permiso=editarSolicitudYIniciarBaremacion noForm  perteneceA ="Baremacion"{
		Accion editar redirigir=PaginaCEconomicos
		Accion crear redirigir=PaginaCEconomicos
		Grupo gInfoPadre titulo="Información Concepto Nivel Superior" permiso=noEditable{
			Texto titulo="Nombre" campo=CEconomico.tipo.nombre
		}
		Form guardarPCE {
			Texto campo=CEconomicosManuales.tipo.nombre titulo="Nombre"
			Boton bGuardarPCE titulo="Guardar"
			Enlace titulo="Volver" estilo="btn btn-link" pagina=PaginaCEconomicos
		}
	}
	
	Popup PopUpCEconomicoManualBorrar titulo="Concepto Económico" campo=SolicitudGenerica.ceconomicos.otros permiso=editarSolicitudYIniciarBaremacion {
		Texto campo=CEconomicosManuales.tipo.nombre titulo="Nombre"
		Texto campo=CEconomicosManuales.tipo.descripcion titulo="Descripción"
	}
	
	//Sobreescrita TODO: REVISAR PERMISOS (con estado?)
	Pagina PaginaCEconomicosEvaluados titulo= "Conceptos Económicos Propuestos y Concedidos" campo=SolicitudGenerica permiso=evaluacionFinalizada noForm  perteneceA ="Baremacion" {
		Form Guardar { 
			Boton botonGuardar titulo="Guardar"
			Boton botonCopiarValores titulo="Copiar Propuestos a Concedidos"  
		}
	}
	
//	Popup temporal titulo="Temporal" campo=SolicitudGenerica.ceconomicos.otros {
//		Tabla tablita titulo="Tablita" campo=CEconomicosManuales popupEditar=PopUpEditarCEconomicosEvaluados {
//				Columna campo=CEconomicosManuales.tipo.jerarquia titulo="Jerarquia"
//				Columna campo=CEconomicosManuales.tipo.nombre titulo="Nombre"
//		}
//	}

Popup PopUpEditarCEconomicosEvaluados titulo="popup" campo=SolicitudGenerica.ceconomicos.otros {
	Grupo noEditable borde=false permiso=noEditable{
		Texto nombre campo=CEconomicosManuales.tipo.nombre titulo="Nombre"
		Texto jerarquia campo=CEconomicosManuales.tipo.jerarquia titulo="Jerarquía"
	}
}
	// ******************************************************************************************
	// PAGINA CONCEPTOS ECONOMICOS COPIA
	// *******************************************************************************************	

	//Sobreescrita
	Pagina PCEconomicosCopia titulo="Conceptos Económicos" permiso=modificacionTrasPresentacionDeSolicitud guardarParaPrepararCopia{
		Form Guardar {
			
			Boton botonGuardar titulo="Guardar" 
		}
	}

	//Sobreescrita
	Pagina PaginaCEconomicosCopia titulo= "Conceptos Económicos" campo=SolicitudGenerica.ceconomicos permiso=modificacionTrasPresentacionDeSolicitud noForm  perteneceA ="Baremacion"{
		Form Guardar { 
			Texto Nombre titulo="Nombre" campo=CEconomico.tipo.nombre
			Grupo conceptosManuales borde=false permiso=verTablaCEconomicosOtros {
				Tabla ceconomicosManuales titulo="Especificar Detalle" campo=CEconomico.otros 
				paginaCrear=PaginaCEconomicoManualCopia 
				paginaEditar=PaginaCEconomicoManualCopia 
				paginaLeer=PaginaCEconomicoManualCopia 
				paginaBorrar=PaginaCEconomicoManualBorrarCopia recargarPagina{
					Columna campo=CEconomicosManuales.tipo.jerarquia titulo="Jerarquía"
					Columna campo=CEconomicosManuales.tipo.nombre titulo="Nombre" expandir
				}
			}
			Boton botonGuardar titulo="Guardar" 
		}
	}

	Pagina PaginaCEconomicoManualBorrarCopia  titulo="Concepto Económico" campo=SolicitudGenerica.ceconomicos.otros permiso=modificacionTrasPresentacionDeSolicitud {
		Accion borrar redirigir=PaginaCEconomicosCopia
		Texto campo=CEconomicosManuales.tipo.nombre titulo="Nombre"
		Texto campo=CEconomicosManuales.tipo.descripcion titulo="Descripción"
	}
	
	//Sobreescrita
	Pagina PaginaCEconomicoManualCopia  titulo="Concepto Económico" campo=SolicitudGenerica.ceconomicos.otros permiso=modificacionTrasPresentacionDeSolicitud noForm  perteneceA ="Baremacion"{
		Accion editar redirigir=PaginaCEconomicosCopia
		Accion crear redirigir=PaginaCEconomicosCopia
		Form guardarPCE {
			Texto campo=CEconomicosManuales.tipo.nombre titulo="Nombre"
			Boton bGuardarPCE titulo="Guardar"
			Enlace titulo="Volver" estilo="btn btn-link" pagina=PaginaCEconomicosCopia
		}
	}

	// ******************************************************************************************
	// ACEPTAR/RENUNCIAR
	// *******************************************************************************************
	
    Pagina PaginaAceptacionRenuncia titulo="Aceptación/Renuncia" noForm  permiso=resolucionAceptarRenunciar perteneceA ="AceptarRenunciar"{
 
         Grupo titulo="Aceptación/Renuncia" {
                Grupo permiso=editarAceptarRenunciar borde=false {
                       Grupo permiso=prepararAceptarRenunciar borde=false {
                              Form formAceptarRenunciar autoEnviar  {
                                    Combo comboAceptarRenunciar campo=SolicitudGenerica.aceptarRenunciar.seleccion titulo="Acepta o Renuncia" requerido
                                    Grupo titulo = "Renuncia" mostrarSiCombo comboAceptarRenunciar='renuncia' borde=false {
                                       AreaTexto titulo="Motivo de renuncia" campo=SolicitudGenerica.aceptarRenunciar.motivoRenuncia filas=10
                                    }
                              }
     
                          Grupo grAceptacion titulo="Aceptación" mostrarSiCombo formAceptarRenunciar.comboAceptarRenunciar='acepta' borde=false {
                             Grupo grSubvencionesAceptarRenunciar titulo="Declaración de Subvenciones" {
                                Tabla tblSubvencion titulo="Ayudas y subvenciones concedidas o solicitadas con el mismo objeto." campo=SolicitudGenerica.aceptarRenunciar.declaracionSubvenciones.subvenciones
                                  popup=PopUpSubvencionAcepta recargarPagina {
                                        Columna titulo="Tipo" campo=SubvencionFap.tipo  ancho="120"
                                        Columna titulo="Admón. o Entidad" campo=SubvencionFap.entidad expandir
                                        Columna titulo="F.Solicitud" campo=SubvencionFap.fechaSolicitud ancho="120"
                                        Columna titulo="F.Aprobación" campo=SubvencionFap.fechaAprobacion ancho="120"
                                        Columna titulo="Situación" campo=SubvencionFap.situacion ancho="100"
                                        Columna titulo="Importe(€)" campo=SubvencionFap.importe ancho="100"
                                                      }
 
 
                                                          Wiki {
                                                              "<div style=\"width:100%;padding:10px;align:right;background-color: #EEEEEE;\">"
                                          "<table style=\"width:90%;text-align:right;align:center;\"><tr>"
                                          "<tr><td><b><i>SUBVENCIÓN</i></b></td><td><b><i>SOLICITADO(€)</i></b></td><td><b><i>CONCEDIDO(€)</i></b></td><td><b><i>TOTAL(€)</i></b></td>"
                                          "<tr><td><b><i>Pública:</i></b></td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadasPublicas)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidasPublicas)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidasPublicas + solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadasPublicas)}</td></tr>"
                                          "<tr><td><b><i>Privada:</i></b></td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadasPrivadas)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidasPrivadas)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidasPrivadas + solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadasPrivadas)}</td></tr>"
                                          "<tr><td><b><i>Minimis:</i></b></td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadasMinimis)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidasMinimis)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidasMinimis + solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadasMinimis)}</td></tr>"
                                          "<tr><td><b><i>Total:</i></b></td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadas)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidas)}</td><td>${format.FapFormat.formatMoneda(solicitud.aceptarRenunciar.declaracionSubvenciones.totalConcedidas + solicitud.aceptarRenunciar.declaracionSubvenciones.totalSolicitadas)}</td></tr>"
                                          "</table>"
                                          "</div>"
                                        }//end wiki
                             }//end grSubvencionesAceptarRenunciar
     
     
                             FirmaMasiva documentos titulo="Documentación Aceptación" campo=SolicitudGenerica.aceptarRenunciar.documentos
                                popupBorrar=PopUpDocAceptacionRenuncia
                                popupEditar=PopUpDocAceptacionRenuncia
                                popupLeer=PopUpDocAceptacionRenuncia
                                paginaCrear=AportarDocumentacionAceptacionRenuncia
                                {
                                   Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
                                   Columna titulo="Tipo Documento" campo=Documento.tipo
                                   Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
                                   Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
                                   Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
                                }
     
     
                          }//end grAceptacion
     
                           Grupo grupoPreparar titulo="Paso 1. Preparar la solicitud de aceptación/renuncia" permiso=generarBorradorAceptarRenunciar/*permiso=presentacionPrepararParaFirmar*/ {
                              Wiki { "Si su solicitud está lista para firmar, pulse el siguiente botón." }
                              Form prepararFirmar {
                                 Boton botonPrepararFirmar titulo="Preparar para firmar" waitPopup
                              }
                           }
                       }//end grPrepararAceptarRenunciar
     
                       Grupo titulo="Paso 2. Obtener borrador de la solicitud de Aceptación/Renuncia" permiso=enBorradorAceptarRenunciar {
                          Wiki {"Puede obtener un borrador de la solicitud de aceptación/renuncia, no válido para su presentación y comprobar que la información introducida es correcta."}
                          Enlace campo=SolicitudGenerica.aceptarRenunciar.registro.borrador.urlDescarga titulo="Obtener borrador" destino="_blank" estilo="boton"
     
                          Form deshacer redirigir=PaginaAceptacionRenuncia permiso=modificarAceptarRenunciar{
                              Wiki {"Puede realizar cambios antes de su presentación definitiva."}
                              Boton botonModificar titulo="Modificar aceptación/renuncia"
                          }
                       }
           }//end grEditarAceptarRenunciar
     
           Grupo grpPresentar titulo="Paso 3. Registrar Aceptación/Renuncia" permiso=enBorradorAceptarRenunciar {
               // Hay que comprobar que se ha guardado formulario antes de pulsar en botonPresentar o que este haga el guardado
               Form frmPresentar redirigir=AceptacionRenunciaPresentar {
                    Wiki {"Debe registrar la aceptación/renuncia para que se considere presentada."}
                    Boton botonPresentar titulo="Presentar Aceptación/Renuncia" pagina=AceptacionRenunciaPresentar waitPopup
               }
           }
 
           Grupo grpDescargarRecibo titulo="Paso 4. Descargar el recibo" permiso=clasificadaAceptarRenunciar {
               Wiki {"Puede obtener un recibo de la presentación de la aceptación/renuncia pulsando el enlace 'Obtener recibo'." }
               Enlace campo=SolicitudGenerica.aceptarRenunciar.registro.justificante.urlDescarga titulo="Obtener recibo"  destino="_blank" estilo="boton"
           }
           
         }//end grAceptarRenunciar
     
       }// end paginaAceptarRenunciar
 
	
	 /*
       * AportarDocumentacionAceptacionRenuncia
       */
    Pagina AportarDocumentacionAceptacionRenuncia titulo="Añadir Documentación Aceptación/Renuncia" campo=SolicitudGenerica.aceptarRenunciar.documentos permiso=editarAceptarRenunciar perteneceA ="AceptarRenunciar"{
        Accion crear redirigir=PaginaAceptacionRenuncia
        SubirArchivo fileAportacion campo=Documento requerido tramite="Aceptación" aportadoPor="CIUDADANO"
    }
    
    Popup PopUpDocAceptacionRenuncia titulo="Documentación" campo=SolicitudGenerica.aceptarRenunciar.documentos {
		EditarArchivo documentoPresentado campo=Documento requerido
	}
	
	Pagina AceptacionRenunciaPresentar titulo="Presentar Aceptacion" noForm  perteneceA ="AceptarRenunciar"{
		
		//Firma persona física	
		Grupo titulo="Paso 3. Firmar y Registrar la Aceptación/Renuncia" mostrarSiCampo SolicitudGenerica.solicitante.tipo="fisica" /*permiso=editarFirma*/{
			Grupo mensajeIntermedioFisica permiso=mensajeIntermedioAceptarRenunciar borde=false {
				Wiki estilo ="alert alert-error" {
					"Se produjo un error en la presentación de la aceptación/renuncia. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
				}
			}			
			Form formFirma permiso=firmarRegistrarAceptarRenunciar redirigir=PaginaAceptacionRenuncia {
		    	Wiki {"La aceptación/renuncia será firmada y registrada."}
				FirmaSimple firmarRegistrarNif titulo="Firmar y registrar" documento=SolicitudGenerica.aceptarRenunciar.registro.oficial calcularFirmantes=SolicitudGenerica.solicitante listaFirmantes=SolicitudGenerica.aceptarRenunciar.registro.firmantes.todos
			}
			
			Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}			
		}			
						
		//Firma Persona jurídica
		Grupo titulo="Paso 3. Firmar y Registrar la Aceptación/Renuncia" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "juridica" {
		
			Grupo mensajeIntermedioJuridica permiso=mensajeIntermedioAceptarRenunciarJuridica borde=false {
				Wiki estilo ="alert alert-error" {
					"Se produjo un error en la presentación de la aceptación/renuncia. Revise los pasos de Firma y/o Registro."
				}
			}
			
			Wiki {"Debe indicar si se firmará la aceptación/renuncia con el certificado electrónico de la empresa o con el certificado electrónico de los representates, si opta por esta última opción y la representación es mancomunada la aceptación/renuncia debe firmarse por todos los representantes mancomunados"}
			
			Form tipoCertificadoFirma autoEnviar {
				Combo certificadoFirma titulo="Certificado que se usará en la firma" campo=SolicitudGenerica.aceptarRenunciar.registro.tipoFirma
			}
					
			Grupo borde=false mostrarSiCampo SolicitudGenerica.aceptarRenunciar.registro.tipoFirma="representantes" {
				Grupo titulo="Paso 3.1. Firmar la Aceptación/Renuncia" permiso=editarFirmaAceptarRenunciar{
				
					Grupo mensajeIntermedioFirmar permiso=mensajeIntermedioAceptarRenunciarFirmar mostrarSiCampo SolicitudGenerica.solicitante.tipo="juridica" borde=false {
						Wiki estilo ="alert alert-error" {
							"Se produjo un error en la presentación de la aceptación/renuncia. Pulse otra vez el botón 'Firmar' para intentar finalizar el proceso."
						}
					}
					
					Wiki {"La aceptación/renuncia será firmada. Cuando todos los representantes hayan firmado podrá registrarla y obtener el recibo de la presentación de la aceptación/renuncia."}
					
					Form formFirmaRepresentante permiso=firmarAceptarRenunciar {
						FirmaSimple firmarRepresentante titulo="Firmar" documento=SolicitudGenerica.aceptarRenunciar.registro.oficial calcularFirmantes=SolicitudGenerica.solicitante listaFirmantes=SolicitudGenerica.aceptarRenunciar.registro.firmantes.todos
					}
					
					Tabla tablaFirmantesHecho campo=SolicitudGenerica.aceptarRenunciar.registro.firmantes.todos recargarPagina  titulo="Representantes que ya han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
						Columna campo=Firmante.fechaFirma titulo="Fecha de firma"
					}
				
					Tabla tablaFirmantesEspera campo=SolicitudGenerica.aceptarRenunciar.registro.firmantes.todos recargarPagina  titulo="Representantes que no han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
					}
				}
				
				Grupo titulo="Paso 3.2. Registrar la Aceptación/Renuncia" permiso=registrarAceptarRenunciar {
				
					Grupo mensajeIntermedioRegistrar permiso=mensajeIntermedioAceptarRenunciarRegistrar mostrarSiCampo SolicitudGenerica.solicitante.tipo="juridica" borde=false {
						Wiki estilo ="alert alert-error" {
							"Se produjo un error en la presentación de la aceptación/renuncia. Pulse otra vez el botón 'Registrar' para intentar finalizar el proceso."
						}
					}
				
					Wiki {"Su aceptación/renuncia ha sido firmada correctamente. Ahora puede presentarla. Una vez presentada podrá obtener el recibo."}
					
					Form formRegistrar redirigir=PaginaAceptacionRenuncia {
						Boton botonRegistrar titulo="Registrar" waitPopup
					}
					
					Wiki {"Nota: La operación de registro puede tardar varios minutos."}
				}
			}

			Grupo borde=false mostrarSiCampo SolicitudGenerica.aceptarRenunciar.registro.tipoFirma="cif" permiso=editarFirmaAceptarRenunciar{
				Wiki {"La aceptación/renuncia será firmada y registrada."}			
				
				Form formFirmaCif redirigir=PaginaAceptacionRenuncia permiso=firmarRegistrarAceptarRenunciar {
					FirmaSimple firmarRegistrarCif titulo="Firmar y Registrar" documento=SolicitudGenerica.aceptarRenunciar.registro.oficial calcularFirmantes=SolicitudGenerica.solicitante listaFirmantes=SolicitudGenerica.aceptarRenunciar.registro.firmantes.todos
				}
			}
		}
		
	}
	
	Popup PopUpSubvencionAcepta titulo="Subvención o ayuda" campo=SolicitudGenerica.aceptarRenunciar.declaracionSubvenciones.subvenciones {
       Grupo titulo="Datos de Subvención"{
           Combo cboTipoSubvencion titulo="Tipo Subvención" campo=SubvencionFap.tipo requerido
           Texto titulo="Administración o Entidad" campo=SubvencionFap.entidad requerido
           AreaTexto ancho="270px" titulo="Objeto" campo=SubvencionFap.objeto requerido
           Combo cboSituacion titulo="Situación" campo=SubvencionFap.situacion requerido
           Fecha titulo="Fecha de solicitud" campo=SubvencionFap.fechaSolicitud requerido
 
           Grupo borde=false mostrarSiCombo cboSituacion="solicitada" {
              Fecha fAprobacion titulo="Fecha de concesión" campo=SubvencionFap.fechaAprobacion
           }
 
           Grupo borde=false mostrarSiCombo cboSituacion="concedida" {
              Fecha fAprobacionRequerida titulo="Fecha de concesión" campo=SubvencionFap.fechaAprobacion requerido
           }
 
           Grupo cboDatosAux borde=false mostrarSiCombo cboTipoSubvencion="minimis","publica" {
               Texto titulo="Fondo"campo=SubvencionFap.fondo
               Texto titulo="Reglamento" campo=SubvencionFap.reglamento
               Texto titulo="Programa operativo" campo=SubvencionFap.programa
           }
 
           Texto titulo="Importe(€)" campo=SubvencionFap.importe requerido
       }
   }
	
	// ******************************************************************************************
	// ALEGACIÓN
	// *******************************************************************************************
	
	Pagina Alegaciones noForm titulo= "Alegaciones"  perteneceA ="Alegacion"{

		Grupo titulo="Nueva Alegación" {
			Grupo permiso=editarAlegacion borde=false {
				Grupo permiso=prepararAlegacion borde=false {
					Form formMotivo autoEnviar {
						AreaTexto titulo ="Texto Alegación" campo = SolicitudGenerica.alegaciones.actual.motivoAlegacion requerido				
						Boton btoGuardar titulo="Guardar trámite"
					}

					FirmaMasiva documentos titulo="Documentos asociados a la alegación"
			    	campo=SolicitudGenerica.alegaciones.actual.documentos
					popupBorrar=PopUpDocAlegacionEnProceso
					popupEditar=PopUpDocAlegacionEnProceso  
					popupLeer=PopUpDocAlegacionEnProceso
					paginaCrear=AportarDocumentacionAlegacion
					{
						Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
						Columna titulo="Tipo Documento" campo=Documento.tipo
						Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
						Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
						Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
					}
			
            		Grupo gpreparar titulo="Paso 1. Preparar la alegación" permiso=generarBorradorAlegacion {
                		Wiki { "Si su solicitud está lista para firmar, pulse el siguiente botón." }                  
                  		Form prepararFirmar {
                        	Boton botonPrepararFirmar titulo="Preparar para firmar" waitPopup
                  		}
            		}
            	}
            
				Grupo titulo="Paso 2. Obtener borrador de la Alegación" permiso=enBorradorAlegacion {
	                  Wiki {"Puede obtener un borrador de la alegación, no válido para su presentación y comprobar que la información introducida es correcta."}	
	                  Enlace campo=SolicitudGenerica.alegaciones.actual.registro.borrador.urlDescarga titulo="Obtener borrador" destino="_blank" estilo="boton"
            
	                  Form deshacer redirigir=Alegaciones permiso=modificarAlegacion {
                        	Wiki {"Puede realizar cambios antes de su presentación definitiva."}
	                        Boton botonModificar titulo="Modificar alegación"
	                  }
                  
//	                  Grupo mensajeIntermedio permiso=mensajeIntermedioAlegacion borde=false {
//	                        Wiki estilo ="box-warn box" {
//	    	                    "Se produjo un error en la presentación de la alegación. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
//    	                    }
//	                  }
            	}
            }
            
            Grupo grpPresentar titulo="Paso 3. Registrar Alegación" permiso=enBorradorAlegacion {  
				// Hay que comprobar que se ha guardado fomulario antes de pulsar en botonPresentar o que este haga el guardado		
				Form frmPresentar redirigir=AlegacionPresentar {
		 			Wiki {"Debe registrar la alegación para que se considere presentada."}
					Boton botonPresentar titulo="Presentar Alegación" pagina=AlegacionPresentar
				}
			}
		}
		
		Grupo titulo="Paso 4. Descargar el recibo" {
			Wiki {"Puede obtener un recibo de la presentación de la alegación pulsando el enlace 'Obtener recibo'." }		
			Tabla alegacionesLista titulo="Alegaciones" 
			campo=SolicitudGenerica.alegaciones.alegacionRegistradas
			popupLeer=PopUpAlegacion
			{
				Columna campo=Alegacion.registro.informacionRegistro.fechaRegistro titulo="Fecha de registro" ancho="150" 
				Columna campo=Alegacion.registro.informacionRegistro.numeroRegistro titulo="Número de registro" ancho="150" 
				Columna funcion="<a href=\"${Alegacion.registro.justificante.urlDescarga}\" target=\"_blank\">Obtener recibo</a>" titulo="Obtener recibo" expandir
			}		
		}
	}
	
	/*
	 * AportarDocumentacionAlegacion
	 */
	Pagina AportarDocumentacionAlegacion titulo="Añadir Documentación Alegación" campo=SolicitudGenerica.alegaciones.actual.documentos permiso=editarAlegacion  perteneceA ="Alegacion"{
		Accion crear redirigir=Alegaciones
		SubirArchivo fileAportacion campo=Documento requerido tramite="Alegacion" aportadoPor="CIUDADANO"	
    }
	
	Pagina AlegacionPresentar titulo="Presentar Alegación" noForm  perteneceA ="Alegacion"{

		//Firma persona física	
		Grupo titulo="Paso 1. Firmar y Registrar la Alegación" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "fisica" permiso=editarFirmaAlegaciones// permiso=presentacionFirmar 
		{
			Grupo mensajeIntermedioFisica permiso=mensajeIntermedioAlegacion borde=false {
				Wiki estilo ="alert alert-error" {
					"Se produjo un error en la presentación de la alegación. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
				}
			}
			Form formFirmaPF redirigir=Alegaciones permiso=firmarRegistrarAlegacion {
		    	Wiki {"La alegación será firmada y registrada." }
				FirmaSimple firmarRegistrarNif titulo="Firmar y registrar" documento=SolicitudGenerica.alegaciones.actual.registro.oficial calcularFirmantes=SolicitudGenerica.solicitante listaFirmantes=SolicitudGenerica.alegaciones.actual.registro.firmantes.todos
			}
			
			Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}
		}			
						
		//Firma Persona jurídica
		Grupo titulo="Paso 1. Firmar y Registrar la Alegación" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "juridica" // permiso=presentacionFirmar 
		{
			Grupo mensajeIntermedioJuridica permiso=mensajeIntermedioAlegacionJuridica borde=false {
				Wiki estilo ="alert alert-error" {
					"Se produjo un error en la presentación de la alegación. Revise los pasos de Firma y/o Registro."
				}
			}
			Wiki {"Debe indicar si se firmará la alegación con el certificado electrónico de la empresa o con el certificado electrónico de los representates, si opta por esta última opción y la representación es mancomunada la aceptación/renuncia debe firmarse por todos los representantes mancomunados"}
			
			Form tipoCertificadoFirma autoEnviar {
				Combo certificadoFirma titulo="Certificado que se usará en la firma" campo=SolicitudGenerica.alegaciones.actual.registro.tipoFirma
			}					
							
			Grupo borde=false mostrarSiCampo SolicitudGenerica.alegaciones.actual.registro.tipoFirma = "representantes" {

				// La firma y registro se hace en dos pasos

				Grupo titulo="Paso 1.1. Firmar la Alegación"  permiso=editarFirmaAlegaciones {
				
					Grupo mensajeIntermedioFirmada mostrarSiCampo SolicitudGenerica.solicitante.tipo = "juridica" permiso=mensajeIntermedioAlegacionFirmar borde=false {
			            Wiki estilo ="alert" {
			            	"Se produjo un error en la presentación de la alegación. Pulse otra vez el botón 'Firmar' para intentar finalizar el proceso."
			            }
			        }
	                
	                Wiki {"La alegación será firmada. Cuando todos los representantes hayan firmado podrá registrarla y obtener el recibo de la presentación de la alegación."}
					
					Form formFirmaRepresentante permiso=firmarAlegacion {
						FirmaSimple firmarRepresentante titulo="Firmar" documento=SolicitudGenerica.alegaciones.actual.registro.oficial calcularFirmantes=SolicitudGenerica.solicitante listaFirmantes=SolicitudGenerica.alegaciones.actual.registro.firmantes.todos
					}
					Tabla tablaFirmantesHecho campo=SolicitudGenerica.alegaciones.actual.registro.firmantes.todos recargarPagina  titulo="Representantes que ya han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
						Columna campo=Firmante.fechaFirma titulo="Fecha de firma"
					}
				
					Tabla tablaFirmantesEspera campo=SolicitudGenerica.alegaciones.actual.registro.firmantes.todos recargarPagina  titulo="Representantes que no han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
					}
				}
					
				Grupo titulo="Paso 1.2. Registrar la Alegación" permiso=registrarAlegacion 
				{
					Grupo mensajeIntermedioRegistrada mostrarSiCampo SolicitudGenerica.solicitante.tipo = "juridica" permiso=mensajeIntermedioAlegacionRegistrar borde=false {
						Wiki estilo ="alert" {
							"Se produjo un error en la presentación de la solicitud. Pulse otra vez el botón 'Registrar' para intentar finalizar el proceso."
						}
					}
					
					Wiki {"Su alegación ha sido firmada correctamente. Ahora puede presentarla. Una vez presentada podrá obtener el recibo."}
			
					Form frmRegistrar redirigir=Alegaciones {
						Boton botonRegistrar titulo="Registrar" waitPopup
					}
			
					Wiki {"Nota: La operación de registro puede tardar varios minutos."}
				}	
			}								

			Grupo borde=false mostrarSiCampo SolicitudGenerica.alegaciones.actual.registro.tipoFirma="cif" permiso=editarFirmaAlegaciones
			{
				Wiki {"La alegación será firmada y registrada. "}

				//La firma y registro se realiza en la misma acción				
				Form formFirmaCif redirigir=Alegaciones permiso=firmarRegistrarAlegacion {
					FirmaSimple firmarRegistrarCif titulo="Firmar y Registrar" documento=SolicitudGenerica.alegaciones.actual.registro.oficial calcularFirmantes=SolicitudGenerica.solicitante listaFirmantes=SolicitudGenerica.alegaciones.actual.registro.firmantes.todos
				}
				Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}
			}			
		}		
	}
	
	Popup PopUpAlegacion titulo="Alegacion" campo=SolicitudGenerica.alegaciones.alegacionRegistradas {
		//Se muestra el motivo de la alegación y la lista de documentos presentados con la alegación		
	    AreaTexto campo=Alegacion.motivoAlegacion filas = 10  titulo="Motivo Alegación"
	    Tabla documentos titulo="Documentos asociados a la alegación" campo=Alegacion.documentos
		{
			Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
			Columna titulo="Tipo Documento" campo=Documento.tipo
			Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
			Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
			Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
		}	
	}
	
	Popup PopUpDocAlegacionEnProceso titulo="Documentación" campo=SolicitudGenerica.alegaciones.actual.documentos {
		EditarArchivo documentoAlegacionEnProceso campo=Documento requerido
	}
	

/*  
 * Autorización de acceso a la solicitud
 */

	Pagina AutorizacionFAP titulo="Usuarios Autorizados" campo=SolicitudGenerica noForm perteneceA ="Principal"{
		Grupo gAutorizaciones titulo="Usuarios Autorizados" permiso=autorizadoNoAutoriza{
			Tabla nipsAutorizados titulo="Autorizados" campo=SolicitudGenerica.autorizacion popup=PopUpAutorizarFAP
			{
				Columna campo=AutorizacionesFAP.numeroIdentificacion titulo="NIF/CIF"
				Columna campo=AutorizacionesFAP.nombreAutorizado titulo="Nombre autorizado" expandir
			}
		}
	}
	
	Popup PopUpAutorizarFAP titulo="Autorizar" campo=SolicitudGenerica.autorizacion permiso=autorizadoNoAutoriza{
		Texto id campo=AutorizacionesFAP.numeroIdentificacion titulo="NIF / CIF" requerido
		Texto nombre campo=AutorizacionesFAP.nombreAutorizado titulo="Nombre autorizado"
	} 

	/*
     * Página Presentar
     */
    Pagina PresentarFAP noForm titulo="Presentación de la Solicitud" campo=SolicitudGenerica.registro  perteneceA ="Presentacion"{

		Grupo titulo="Presentación de la solicitud" {
			Grupo permiso=prepararSolicitud borde = false { 
        		Grupo gpreparar titulo="Paso 1. Preparar la solicitud"  {
            		Wiki { "Si su solicitud está lista para firmar, pulse el siguiente botón." }
              		Form prepararFirmar {
                    	Boton botonPrepararFirmar titulo="Preparar para firmar" waitPopup
              		}
        		}
        	} // Fin Grupo para controlar prepararAlegacion

			Grupo titulo="Paso 2. Obtener borrador de la Solicitud" permiso=enBorradorSolicitud {
				Wiki {"Puede obtener un borrador de la solicitud, no válido para su presentación y comprobar que la información introducida es correcta."}
				Enlace campo=Registro.borrador.urlDescarga titulo="Obtener borrador" destino="_blank" estilo="boton"

				Form deshacer permiso=modificarSolicitud {
					Wiki {"Para realizar cambios o aportar documentos, antes de su presentación definitiva, pulse el siguiente botón."}
					Boton botonModificar titulo="Modificar solicitud"
					Wiki {"<b><u>NOTA: </u></b>Recuerde que también es posible aportar los documentos después de presentar su solicitud."}

				}

				Grupo mensajeIntermedio permiso=mensajeIntermedioSolicitud borde=false {
					Wiki estilo ="box-warn box" {
							"Se produjo un error en la presentación de la solicitud. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
					}
				}
			}

			// Hay que comprobar que se ha guardado fomulario antes de pulsar en botonPresentar o que este haga el guardado
			Grupo grpPresentar titulo="Paso 3. Firmar y Registrar la Solicitud" permiso=enBorradorSolicitud {
				// Hay que comprobar que se ha guardado fomulario antes de pulsar en botonPresentar o que este haga el guardado
				Form frmPresentar redirigir=SolicitudPresentarFAP permiso=enBorradorSolicitud {
					Wiki {"Debe registrar la solicitud para que se considere presentada."}
					Boton botonPresentar titulo="Presentar solicitud"
				}
			}

			// Hay que poner bien el permiso
			Grupo grpDescargarRecibo titulo="Paso 4. Descargar el recibo" permiso=clasificadaSolicitud {
				Wiki {"Puede obtener un recibo de la presentación de la solicitud pulsando el enlace 'Obtener recibo'." }
				Enlace campo=Registro.justificante.urlDescarga titulo="Obtener recibo"  destino="_blank" estilo="boton"
			}
		}
		
		Grupo titulo="Presentación de modificaciones"  mostrarSiExpresion "!solicitud.registroModificacion.isEmpty()" {
			Tabla tablaModificaciones campo=SolicitudGenerica.registroModificacion titulo="Modificaciones Presentadas" recargarPagina {
				Columna campo=RegistroModificacion.fechaCreacion titulo="Fecha Creación" expandir
				Columna campo=RegistroModificacion.fechaLimite titulo="Fecha Límite" expandir
				Columna campo=RegistroModificacion.fechaRegistro titulo="Fecha Registro" expandir
				Columna campo=RegistroModificacion.estado titulo="Estado" expandir
				Columna campo=RegistroModificacion.registro.justificante.enlaceDescarga titulo="Justificante" expandir
			}
		}
	}

	// Sobreescrito
	Pagina SolicitudPresentarFAP titulo="Presentar Solicitud" noForm campo=SolicitudGenerica.registro perteneceA ="Presentacion"{
		
		Grupo borde=false mostrarSiCampo SolicitudGenerica.activoFH="true"{
			Grupo titulo="Firma Requerida a Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=habilitarFHPresentacion{
				Form formHabilitarFH {
					Boton btnHabilitarFH titulo="Habilitar a los Funcionarios para firmar en mi nombre"
				}
				Grupo borde=false mostrarSiCampo Registro.habilitaFuncionario="true"{
					Wiki{"Ya ha sido requerida la firma por un Funcionario habilitado, en breve un funcionario lo firmará y registrará."}
				}
			}
		
			// Sobreescrito HTML
			//Firma Funcionario Habilitado
			Grupo borde=false mostrarSiCampo Registro.habilitaFuncionario="true"{
				Grupo titulo="Paso 3. Firmar y Registrar la solicitud" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.presentacion.firmaYRegistro.funcionarioHabilitado\")" permiso=firmarRegistrarSolicitudFH
				{
					Form formFirmaFH { 
				    	Wiki {"La solicitud será firmada y registrada." }
						FirmaSimple firmarRegistrarFH titulo="Firmar y registrar" documento=SolicitudGenerica.registro.oficial listaFirmantes=SolicitudGenerica.registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante
					}
		
					Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}
				}
			}
		 }

		//Firma persona física
		Grupo titulo="Paso 3. Firmar y Registrar la solicitud" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "fisica" permiso=firmarRegistrarSolicitud
		{
			Form formFirmaPF { 
		    	Wiki {"La solicitud será firmada y registrada." }
				FirmaSimple firmarRegistrarNif titulo="Firmar y registrar" documento=SolicitudGenerica.registro.oficial listaFirmantes=SolicitudGenerica.registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante
			}

			Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}
		}

		//Firma Persona jurídica
		Grupo titulo="Paso 3. Firmar y Registrar la solicitud" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "juridica" permiso=firmarRegistrarSolicitud
		{

			// La firma y registro se hace en dos pasos
				Grupo titulo="Paso 3.1. Firmar la solicitud" permiso=firmarSolicitud{
					Wiki {"La solicitud debe firmarse con el Certificado electrónico del solicitante o el de uno de los representantes del solicitante. Si la representación es  mancomunada todos los representantes deben firmar la solicitud."}

					Form formFirmaRepresentante permiso=firmarSolicitud {
						FirmaSimple firmarRepresentante titulo="Firmar" documento=SolicitudGenerica.registro.oficial listaFirmantes=SolicitudGenerica.registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante
					}

					Tabla tablaFirmantesHecho campo=SolicitudGenerica.registro.firmantes.todos recargarPagina  titulo="Representantes que ya han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
						Columna campo=Firmante.fechaFirma titulo="Fecha de firma"
					}

					Tabla tablaFirmantesEspera campo=SolicitudGenerica.registro.firmantes.todos recargarPagina  titulo="Representantes que no han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
					}
				}

				Grupo titulo="Paso 3.2. Registrar la solicitud" permiso=registrarSolicitud
				{
					Wiki {"Su solicitud ha sido firmada correctamente. Ahora puede presentarla. Una vez presentada podrá obtener el recibo."}

					Form frmRegistrar redirigir=PresentarFAP {
						Boton botonRegistrar titulo="Registrar" waitPopup
					}

					Wiki {"Nota: La operación de registro puede tardar varios minutos."}
				}
			}
	}
	
	Pagina ActivarFuncionarioHabilitado titulo="Activar Posibilidadad de Requerir Firma de Funcionario Habilitado" permiso=adminOrGestor noForm{
		
		Grupo titulo="Activar Posibilidadad de Requerir Firma de Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=ActivarHabilitarFH{
			Form formActivarFH {
				Boton activarFH titulo="Activar Funcionario Habilitado"
			}
			Grupo borde=false mostrarSiCampo SolicitudGenerica.activoFH="true"{
				Wiki{"Ya ha sido activada la posibilidad de habilitar la firma de un Funcionario Habilitado."}
			}
		}
	}
	


	Pagina CertificadosSolicitados titulo="Solicitar Certificado" noForm{
		Tabla tablaCertificados titulo="Certificados Solicitados" campo=SolicitudGenerica.certificados paginaCrear=PedirCertificado { 
			Columna titulo="Nombre" campo=CertificadoSolicitado.tipo.nombre
			Columna funcion="<a href=\"${CertificadoSolicitado.documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="80"
			Columna titulo="Descripción" campo=CertificadoSolicitado.tipo.descripcion expandir
			Columna titulo="Fecha Emisión" campo=CertificadoSolicitado.fechaCreacion ancho="90"
			Columna titulo="Validez (en meses)" campo=CertificadoSolicitado.tipo.validez ancho="100"
		}
	}
	
	Pagina PedirCertificado titulo="Solicitar Certificado Nuevo" campo=SolicitudGenerica.certificados noForm {
		Grupo titulo="Solicitar Certificado" {
			Form pedirCertificado {
				Combo tipoCertificado titulo="Tipo Certificado" campo=CertificadoSolicitado.tipo.tipoDocumento
				Boton obtenerCertificado titulo="Obtener Certificado"
			}
		}
	}

	/*
	 * Trámite Justificación
	 */
	
	Pagina Justificacion titulo="Justificación" perteneceA ="Justificacion"{
		
		Enlace titulo="Consultar documentos de justificación ya aportados" pagina=JustificacionAportados estilo="btn"
		Enlace titulo="Consultar recibos de justificaciones" pagina=JustificacionRecibos estilo="btn"
		
		Grupo titulo="Paso 1. Agregar Nuevos Documentos de Justificacion"{
			Wiki {"A partir de las plantillas que se adjuntan en la convocatoria, y una vez rellenadas correctamente, deberá añadirlas como documentación indicando el tipo de documento correspondiente."}
	
			Tabla documentos 
			    titulo="Documentos nuevos pendientes de aportar" 
			    campo=SolicitudGenerica.justificaciones.actual.documentos
				popupBorrar=PopUpDocJustificacionProcesos
				popupEditar=PopUpDocJustificacionProcesos  
				popupLeer=PopUpDocJustificacionProcesos
				paginaCrear=DocumentosJustificacion
			{
				Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
				Columna titulo="Tipo Documento" campo=Documento.tipo
				Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
				Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
				Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
			}
		}
		
		Grupo titulo="Incorporar Documentos sin Registro de Entrada" permiso=adminGestorRevisor {
			Form presentarSinRegistrar redirigir=JustificacionRecibos {
				Fecha fechaJustificacionSinRegistrar titulo="Fecha Incorporación" campo=SolicitudGenerica.justificaciones.actual.fechaJustificacionSinRegistro requerido
				Boton justificarSinRegistrar titulo="Incorporar" waitPopup
			}
		}
		
		Grupo titulo="Paso 1b. Registrar los documentos"{
			Form presentar redirigir=JustificacionPresentar permiso=justificacionDocumentos {
				Wiki {"Debe registrar los documentos para que se consideren aportados a la solicitud."}
				Boton botonPresentar titulo="Preparar para registrar"
			}
		}
		
	}
	
	Pagina DocumentosJustificacion titulo="Justificacion Nuevo Documento" campo=SolicitudGenerica.justificaciones.actual.documentos perteneceA ="Justificacion"{
		Accion crear redirigir=Justificacion
		Grupo gSubirDocumento titulo="Aportar Documento de Justificación"{
			SubirArchivo fileJustificacion campo=Documento requerido tramite="Solicitud" aportadoPor="CIUDADANO" listarDocumentosSubidos
		}
	}
	
	Pagina JustificacionAportados titulo="Documentos Justificados" perteneceA ="Justificacion"{		
		Tabla documentos titulo="Documentos Presentados" 
		    campo=SolicitudGenerica.documentacion.documentos
			popupLeer=PopUpDocJustificacionPresentados
		{
			Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80" 
			Columna titulo="Tipo Documento" campo=Documento.tipo
			Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
			Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
			Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
		}

		Grupo documentosExternos borde=false mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.documentacion.documentosExternos\")"{
			Tabla documentosExternos titulo="Documentos Externos" campo=SolicitudGenerica.documentacion.documentosExternos popupLeer=DocumentosExternosLeerFAP {
				Columna titulo="Id" campo=DocumentoExterno.id
				Columna titulo="Tipo Documento" campo=DocumentoExterno.tipo
				Columna titulo="Descripcion" campo=DocumentoExterno.descripcionVisible expandir
			}
		}
		
		Enlace titulo="Volver" pagina=Justificacion estilo="btn"
	}	
	
	Pagina JustificacionRecibos titulo="Recibos de Justificaciones aportadas" noForm  perteneceA ="Justificacion"{
			
		Tabla recibosJustificacion titulo="Recibos de las justificaciones" campo=SolicitudGenerica.documentacionJustificacion.documentos permisoFilas=justificacionNoNull
		{
			Columna campo=Documento.fechaSubida titulo="Fecha Subida" ancho="80"
			Columna campo=Documento.fechaRegistro titulo="Fecha Registro" ancho="80"
			Columna titulo="Tipo Documento" campo=Documento.tipo
			Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
			Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
			Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
		}
		
		Enlace titulo="Volver" pagina=Justificacion estilo="btn"
	}
	
	Popup PopUpDocJustificacionPresentados titulo="Documentación" campo=SolicitudGenerica.documentacion.documentos{
		EditarArchivo documentoPresentado campo=Documento requerido
	}
	
	Popup PopUpDocJustificacionProcesos titulo="Documentación" campo=SolicitudGenerica.justificaciones.actual.documentos{
		EditarArchivo documentoProceso campo=Documento requerido
	}
	
	Popup PopUpDocJustificacionAportados titulo="Documentación" campo=SolicitudGenerica.documentacionJustificacion.documentos {
		EditarArchivo documentoAportado campo=Documento requerido
	}
		
	// Sobreescrita
	Pagina JustificacionPresentar titulo="Presentar la Justificación" noForm perteneceA ="Justificacion"{
	  	Grupo titulo="Presentar Justificación de Documentos" {
			Wiki {"Puede obtener un borrador de la solicitud de justificacion de documentación, no válido para su presentación y comprobar que la información introducida es correcta."}

			Enlace campo=SolicitudGenerica.justificaciones.actual.registro.borrador.urlDescarga titulo="Obtener borrador" destino="_blank" estilo="btn"
		
			Form modificarBorrador redirigir=Justificacion permiso=justificacionModificar{
				Wiki {"Puede realizar cambios antes de su presentación definitiva."}
				Boton botonModificarBorrador titulo="Modificar datos"
			}
			
			Tabla documentos 
		    	titulo="Documentos aportados que se van a registrar" 
		    	campo=SolicitudGenerica.justificaciones.actual.documentos
				popupLeer=PopUpDocJustificacionProcesos
			{
				Columna campo=Documento.fechaSubida titulo="Fecha" ancho="80"
				Columna campo=Documento.fechaRegistro titulo="Fecha Registro" ancho="80"
				Columna titulo="Tipo Documento" campo=Documento.tipo
				Columna campo=Documento.descripcionVisible titulo="Descripción" expandir
				Columna funcion="<a href=\"${Documento.urlDescarga}\" target=\"_blank\">Descargar</a>" titulo="Descargar" ancho="100"
				Columna funcion="${Documento.enlaceDescargaFirmado}" titulo="Descargar Firmado" ancho="110"
			}
			
//			Grupo mensajeIntermedio permiso=aportacionMensajeIntermedio borde=false {
//				Wiki estilo ="box-warn box" {
//					"Se produjo un error en la presentación de la justificación. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
//				}
//			}
			
			// Sobreescrito HTML
			
			Grupo borde=false mostrarSiCampo SolicitudGenerica.activoFH="true"{
				Grupo titulo="Firma Requerida a Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=habilitarFHJustificacion{
					Form formHabilitarFH {
						Boton btnHabilitarFH titulo="Habilitar a los Funcionarios para firmar en mi nombre"
					}
					Grupo borde=false mostrarSiCampo SolicitudGenerica.registro.habilitaFuncionario="true"{
						Wiki{"Ya ha sido habilitada la opción de que un funcionario habilitado pueda firmar y registrar."}
					}
				}
			}
			
			//Firma Funcionario Habilitado
			Grupo borde=false mostrarSiCampo SolicitudGenerica.justificaciones.actual.habilitaFuncionario="true"{
				Grupo titulo="Paso 2. Presentar los Documentos por Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=firmarRegistrarJustificacionFH
				{
					Wiki{"**NOTA: Debe finalizar el Paso 2 pulsando en el botón 'Firmar y presentar' para que los Nuevos Documentos se consideren presentados. Cuando el proceso finalice los documentos nuevos desaparecerán del Paso 1 y se incorporarán a la lista de Documentos Presentados.**"}
					Wiki{"La solicitud será firmada y registrada. Puede obtener un recibo de la presentación de la solicitud una vez 'Firmar y Presentar' se haya realizado con éxito"}
					Form formFirmaFH { 
						FirmaSimple firmarRegistrarFH titulo="Firmar y presentar por Funcionario Habilitado" 
							documento=SolicitudGenerica.justificaciones.actual.registro.oficial
							listaFirmantes=SolicitudGenerica.registro.firmantes.todos
							calcularFirmantes=SolicitudGenerica.solicitante
					}
				}
			}
			
			Grupo titulo="Paso 2. Presentar los Documentos"{
				Wiki{"**NOTA: Debe finalizar el Paso 2 pulsando en el botón 'Firmar y presentar' para que los Nuevos Documentos se consideren presentados. Cuando el proceso finalice los documentos nuevos desaparecerán del Paso 1 y se incorporarán a la lista de Documentos Presentados.**"}
				Wiki{"La solicitud será firmada y registrada. Puede obtener un recibo de la presentación de la solicitud una vez 'Firmar y Presentar' se haya realizado con éxito"}
				Form presentar redirigir=JustificacionRecibos {
					FirmaSimple firmarRepresentante titulo="Firmar y presentar"
						documento=SolicitudGenerica.justificaciones.actual.registro.oficial
						listaFirmantes=SolicitudGenerica.registro.firmantes.todos
						calcularFirmantes=SolicitudGenerica.solicitante
				}
			}
			
			Wiki {"Nota: La operación de firmar y presentar puede tardar varios minutos."}
		}
	}
	


	Popup PopupCrearModificacionSolicitud campo=SolicitudGenerica.registroModificacion titulo="Habilitar una nueva Modificación" permiso=crearModificacionSolicitud {
		Grupo titulo="Habilitar una nueva Modificación de la Solicitud para el Solicitante" {
			Fecha fechaLimite campo=RegistroModificacion.fechaLimite titulo="Fecha Límite de Modificación" requerido
		}
	}

	Popup PopupEditarModificacionSolicitud campo=SolicitudGenerica.registroModificacion titulo="Editar modificación" permiso=editarModificacionSolicitud {
		Grupo titulo="Cambiar la fecha límite de modificación" {
			Fecha fechaLimite campo=RegistroModificacion.fechaLimite titulo="Fecha Límite de Modificación" requerido
		}
	}
	
	Popup PopupLeerModificacionSolicitud campo=SolicitudGenerica.registroModificacion titulo="Datos Modificación" permiso=adminOrGestorOrRevisor{
		Grupo titulo="Datos de la Modificación" permiso=noEditable{
			Texto estado campo=RegistroModificacion.estado titulo="Estado Actual"
			Fecha fechaCreacion campo=RegistroModificacion.fechaCreacion titulo="Fecha de Creación"
			Fecha fechaLimite campo=RegistroModificacion.fechaLimite titulo="Fecha Limite"
			Fecha fechaRegistro campo=RegistroModificacion.registro.informacionRegistro.fechaRegistro titulo="Fecha Registro"
		}
	}
	
	Pagina ActivarModificacionSolicitudes titulo="Habilitar Modificación Solicitud" campo=SolicitudGenerica noForm permiso=habilitarModificacionSolicitud {
		Grupo titulo="Modificaciones de los Datos de la Solicitud por parte del Solicitante" {
			Tabla tablaModificaciones campo=SolicitudGenerica.registroModificacion titulo="Modificaciones Totales" popupCrear=PopupCrearModificacionSolicitud popupEditar=PopupEditarModificacionSolicitud popupLeer=PopupLeerModificacionSolicitud permisoFilas=filaTablaModificaciones recargarPagina{
				Columna campo=RegistroModificacion.fechaCreacion titulo="Fecha Creación" expandir
				Columna campo=RegistroModificacion.fechaRegistro titulo="Fecha Registrada" expandir
				Columna campo=RegistroModificacion.fechaCancelacion titulo="Fecha Cancelada" expandir
				Columna campo=RegistroModificacion.fechaLimite titulo="Fecha Límite" expandir
				Columna campo=RegistroModificacion.estadoValue titulo="Estado" expandir
				Columna campo=RegistroModificacion.registro.justificante.enlaceDescarga titulo="Justificante" expandir
			}
		}
		
		Grupo titulo="Restaurar valores de los Datos de la Solicitud" mostrarSiExpresion "!solicitud.registroModificacion.isEmpty() && ((solicitud.registroModificacion.get(solicitud.registroModificacion.size()-1).estado == \"enCurso\" ) || (solicitud.registroModificacion.get(solicitud.registroModificacion.size()-1).estado == \"expirada\" ))"  {
			Form formRestaurarModificacion {
				Combo fechaARestaurar campo=SolicitudGenerica.fechaARestaurarStr titulo="Fecha Creación de la Modificación" requerido // Sobreescrito
				Boton restaurarBtn titulo="Restaurar" type=danger
			}
		}
	}
	
	/*
     * Página Presentar
     */
    Pagina PresentarModificacionFAP noForm titulo="Presentación de las Modificaciones de la Solicitud" campo=SolicitudGenerica.registroModificacion.registro  perteneceA ="Presentacion"{

		Grupo titulo="Presentación de la Modificación de la solicitud" {
			Grupo permiso=presentarModificacionTrasPresentacionDeSolicitud borde=false{
				Grupo permiso=prepararSolicitudModificacion borde = false {
	        		Grupo gpreparar titulo="Paso 1. Preparar la solicitud de modificación" {
	            		Wiki { "Si su solicitud de modificación está lista para firmar, pulse el siguiente botón." }
	              		Form prepararFirmar {
	                    	Boton botonPrepararFirmar titulo="Preparar para firmar" waitPopup
	              		}
	        		}
	        	} // Fin Grupo para controlar prepararAlegacion
	
				Grupo titulo="Paso 2. Obtener borrador de la Solicitud de Modificación" permiso=enBorradorSolicitudModificada {
					Wiki {"Puede obtener un borrador de la solicitud de modificación, no válido para su presentación y comprobar que la información introducida es correcta."}
					Enlace campo=Registro.borrador.urlDescarga titulo="Obtener borrador" destino="_blank" estilo="boton"
	
					Form deshacer permiso=modificarSolicitudModificada {
						Wiki {"Para realizar cambios, antes de su presentación definitiva, pulse el siguiente botón."}
						Boton botonModificar titulo="Modificar solicitud de modificación"
					}
	
					Grupo mensajeIntermedio permiso=mensajeIntermedioSolicitudModificada borde=false {
						Wiki estilo ="box-warn box" {
							"Se produjo un error en la presentación de la solicitud de modificación. Pulse otra vez el botón 'Firmar y presentar' para intentar finalizar el proceso."
						}
					}
				}
			}
			// Hay que comprobar que se ha guardado fomulario antes de pulsar en botonPresentar o que este haga el guardado
			Grupo grpPresentar titulo="Paso 3. Firmar y Registrar la Solicitud de Modificación" permiso=enBorradorSolicitudModificada {
				// Hay que comprobar que se ha guardado fomulario antes de pulsar en botonPresentar o que este haga el guardado
				Form frmPresentar redirigir=SolicitudPresentarModificacionFAP permiso=enBorradorSolicitudModificada {
					Wiki {"Debe registrar la solicitud para que se considere presentada."}
					Boton botonPresentar titulo="Presentar solicitud de Modificación" waitPopup
				}
			}
				
		Grupo grpDescargarRecibo titulo="Paso 4. Descargar el recibo" permiso=clasificadaSolicitudModificada {
			Wiki {"Puede obtener un recibo de la presentación de la solicitud de modificación pulsando el enlace 'Obtener recibo'." }
			Enlace campo=Registro.justificante.urlDescarga titulo="Obtener recibo"  destino="_blank" estilo="boton"
		}
		}

	}

	Pagina SolicitudPresentarModificacionFAP titulo="Presentar Solicitud de Modificación" noForm permiso=presentarModificacionTrasPresentacionDeSolicitud campo=SolicitudGenerica.registroModificacion.registro perteneceA ="Presentacion"{
		
		Grupo borde=false mostrarSiCampo SolicitudGenerica.activoFH="true"{
			Grupo titulo="Firma Requerida a Funcionario Habilitado" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.firmaYRegistro.funcionarioHabilitado\")" permiso=habilitarFHPresentacionModificada{
				Form formHabilitarFH {
					Boton btnHabilitarFH titulo="Habilitar a los Funcionarios para firmar en mi nombre"
				}
				Grupo borde=false mostrarSiCampo Registro.habilitaFuncionario="true"{
					Wiki{"Ya ha sido requerida la firma por un Funcionario habilitado, en breve un funcionario lo firmará y registrará."}
				}
			}

			//Firma Funcionario Habilitado
			Grupo borde=false mostrarSiCampo Registro.habilitaFuncionario="true"{
				Grupo titulo="Paso 3. Firmar y Registrar la solicitud" mostrarSiExpresion "properties.FapProperties.getBoolean(\"fap.presentacion.firmaYRegistro.funcionarioHabilitado\")" permiso=firmarRegistrarSolicitudModificadaFH
				{
					Form formFirmaFH { 
				    	Wiki {"La solicitud de modificación será firmada y registrada." }
						FirmaSimple firmarRegistrarFH titulo="Firmar y registrar" documento=Registro.oficial registroFirma=Registro listaFirmantes=Registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante
					}
		
					Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}
				}
			}
		 }

		//Firma persona física
		Grupo titulo="Paso 3. Firmar y Registrar la solicitud de modificación" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "fisica" permiso=firmarRegistrarSolicitudModificada
		{
			Form formFirmaPF { 
		    	Wiki {"La solicitud de modificación será firmada y registrada." }
				FirmaSimple firmarRegistrarNif titulo="Firmar y registrar" documento=Registro.oficial registroFirma=Registro listaFirmantes=Registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante
			}

			Wiki {"Nota: La operación de firmar y registrar puede tardar varios minutos."}
		}

		//Firma Persona jurídica
		Grupo titulo="Paso 3. Firmar y Registrar la solicitud de modificación" mostrarSiCampo SolicitudGenerica.solicitante.tipo = "juridica" permiso=firmarRegistrarSolicitudModificada
		{

			// La firma y registro se hace en dos pasos
				Grupo titulo="Paso 3.1. Firmar la solicitud de modificación" permiso=firmarSolicitudModificada{
					Wiki {"La solicitud de modificación debe firmarse con el Certificado electrónico del solicitante o el de uno de los representantes del solicitante. Si la representación es  mancomunada todos los representantes deben firmar la solicitud."}

					Form formFirmaRepresentante permiso=firmarSolicitudModificada {
						FirmaSimple firmarRepresentante titulo="Firmar" documento=Registro.oficial registroFirma=Registro listaFirmantes=Registro.firmantes.todos calcularFirmantes=SolicitudGenerica.solicitante
					}

					Tabla tablaFirmantesHecho campo=Registro.firmantes.todos recargarPagina  titulo="Representantes que ya han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
						Columna campo=Firmante.fechaFirma titulo="Fecha de firma"
					}

					Tabla tablaFirmantesEspera campo=Registro.firmantes.todos recargarPagina  titulo="Representantes que no han firmado" {
						Columna campo=Firmante.idvalor titulo="NIP"
						Columna campo=Firmante.nombre titulo="Nombre" expandir
					}
				}

				Grupo titulo="Paso 3.2. Registrar la solicitud de modificación" permiso=registrarSolicitudModificada
				{
					Wiki {"Su solicitud de modificación ha sido firmada correctamente. Ahora puede presentarla. Una vez presentada podrá obtener el recibo."}

					Form frmRegistrar redirigir=PresentarModificacionFAP {
						Boton botonRegistrar titulo="Registrar" waitPopup
					}

					Wiki {"Nota: La operación de registro puede tardar varios minutos."}
				}
			}
	}
	
	//---------------------------------------------------------------------------
   //-------------------------Comunicaciones Internas --------------------------
   //---------------------------------------------------------------------------
	
	Pagina ComunicacionesInternas campo=SolicitudGenerica titulo="Comunicaciones Internas" permiso=adminOrGestor noForm{
		Tabla tablaComunicaciones titulo="Comunicaciones Internas" campo=SolicitudGenerica.comunicacionesInternas 
		paginaLeer=PaginaDatosLeerComunicacionInterna paginaCrear=PaginaDatosNuevaComunicacionInterna paginaEditar=PaginaDatosNuevaComunicacionInterna
		popupBorrar=PopupBorrarComunicacionInterna permisoFilas=tblComunicacionesInternas
      {
			Columna campo=ComunicacionInterna.asiento.unidadOrganicaDestino.descripcion titulo="Unidad orgánica destino" ancho="150"
			Columna campo=ComunicacionInterna.asiento.resumen titulo="Resumen" ancho="180"
			Columna funcion="${ComunicacionInterna.numRegistroHiperReg}" titulo="Número de registro" ancho="100"
            Columna funcion="${ComunicacionInterna.fechaHiperReg}" titulo="Fecha" ancho="150"
			Columna campo=ComunicacionInterna.estado titulo="Estado" expandir
		}
	}
	
	Pagina PaginaDatosLeerComunicacionInterna titulo="Datos de la comunicación" campo=SolicitudGenerica.comunicacionesInternas noForm {
	   Grupo titulo="Datos petición Comunicación interna " {
	      Texto usuario campo=ComunicacionInterna.asiento.userId titulo="Usuario"
   	      Texto interesado campo=ComunicacionInterna.asiento.interesado titulo="Interesado"
   	      Texto uoOrigen campo=ComunicacionInterna.asiento.unidadOrganicaOrigen.descripcion titulo="Unidad orgánica de origen"
   		  Texto uoDestino campo=ComunicacionInterna.asiento.unidadOrganicaDestino.descripcion titulo="Unidad orgánica de destino"
   		  AreaTexto resumen campo=ComunicacionInterna.asiento.resumen titulo="Resumen"
   		  AreaTexto observaciones campo=ComunicacionInterna.asiento.observaciones titulo="Observaciones" 
   		
   		  Tabla documentosCI campo=ComunicacionInterna.asiento.uris titulo="Documento y anexos" {
            Columna titulo="Descripción" campo=Documento.descripcionVisible expandir
            Columna titulo="Descargar" campo=Documento.enlaceDescarga
            Columna titulo="Descargar Firmado" campo=Documento.enlaceDescargaFirmado
          }
	   }
		
	   Grupo titulo="Datos Respuesta" {
		   Texto fecha campo=ComunicacionInterna.respuesta.fecha titulo="Fecha de alta"
           Texto hora campo=ComunicacionInterna.respuesta.hora titulo="Hora de alta"
           Texto ejercicio campo=ComunicacionInterna.respuesta.ejercicio titulo="Ejercicio"
           Texto tipo campo=ComunicacionInterna.respuesta.tipoComunicacion titulo="Tipo de comunicación"
           Texto numComunicaion campo=ComunicacionInterna.respuesta.contadorUO titulo="ContadorUO"
		   Texto numRegistro campo=ComunicacionInterna.respuesta.numeroRegistro titulo="Número de registro"
		}
		
		Form frmVolverComunicacionInternas {
            Boton btnVolverComunicacionInternas titulo="Volver" pagina=ComunicacionesInternas
      }
	}
	
	Popup PopupBorrarComunicacionInterna titulo="Borrar comunicación interna" campo=SolicitudGenerica.comunicacionesInternas permiso=ComunicacionesInternas{
	    Accion borrar redirigir=ComunicacionesInternas
	    Wiki{"¿ Está seguro de borrar la comunicación interna ?"}
	}
	
	Pagina PaginaDatosNuevaComunicacionInterna titulo="Crear una nueva Comunicación Interna" campo=SolicitudGenerica.comunicacionesInternas permiso=ComunicacionesInternas{
      Accion crear redirigir=PaginaNuevaComunicacionInternaDocumentos
      Accion editar redirigir=PaginaNuevaComunicacionInternaDocumentos
      
       Grupo titulo="Datos de la Comunicación Interna"{
         Texto interesado titulo="Nombre completo del interesado" campo=ComunicacionInterna.asiento.interesado
         AreaTexto resumen titulo="Resumen" campo=ComunicacionInterna.asiento.resumen requerido
         Check uoOrigenDefecto titulo="Especificar una unidad orgánica de origen" campo=ComunicacionInterna.asiento.asientoAmpliado 
         ayuda = "En el caso de que no se especifique una unidad orgánica de origen se utilizará la asignada por defecto." 
         Grupo titulo="Unidad Orgánica de origen" mostrarSiCheck uoOrigenDefecto = true {
            ComboUO uoOrigen campo=ComunicacionInterna.asiento.unidadOrganicaOrigen.codigo requerido busqueda 
         }
         Grupo titulo="Unidad Orgánica de destino" {
            ComboUO uoDestino campo=ComunicacionInterna.asiento.unidadOrganicaDestino.codigo requerido busqueda
         }
       }
   } 

	Pagina PaginaNuevaComunicacionInternaDocumentos titulo="Aportar documentación" campo=SolicitudGenerica.comunicacionesInternas  noForm{
		Grupo titulo = "Selección del documento principal"{
			Wiki{"Recuerde que debe seleccionar un documento como máximo. Cada nueva selección sobrescribirá la anterior."}
			Tabla tblDocPrincipal campo=SolicitudGenerica.documentacion.documentos seleccionable="Seleccionar" titulo="Seleccione un documento como máximo"{
				Columna titulo="Descripción" campo=Documento.descripcionVisible expandir
				Columna titulo="Descargar" campo=Documento.enlaceDescarga 
				Columna titulo="Descargar Firmado" campo=Documento.enlaceDescargaFirmado
			}
		}
		
	   Grupo titulo="No aportar documentación" {
	      Wiki{"Se eliminará cualquier selección de documentos hecha previamente."}
	      Form frmNoAportarDocumentacion {
            Boton btnNuevaComunicacionInternaDocumentos titulo="Siguiente"
         }
      }
	}
	
	Popup PopupBorrarDocumentosAsociadosAltaCI titulo="Excluir documento asociado al alta de la comunicación interna" campo=SolicitudGenerica.comunicacionesInternas.asiento.uris{
        Accion borrar redirigir=PaginaAltaComunicacionInterna
        Wiki{"¿ Está seguro de excluir el documento ?"}
    }
	
	Pagina PaginaAltaComunicacionInterna titulo="Alta de comunicación" campo=SolicitudGenerica.comunicacionesInternas noForm{
		Accion editar crearSiempre 
		Form frmNuevoAsiento {
		   
		   Grupo titulo="Credenciales de la comunicación" {
            Texto userID titulo="Usuario" campo=ComunicacionInterna.asiento.userId requerido
            Texto passwd titulo="Clave" campo=ComunicacionInterna.asiento.password requerido password
         }
		   
		   Grupo titulo="Datos adicionales" {
            Grupo titulo = "Selección de documentos anexos" mostrarSiExpresion "comunicacionInterna.estado == \"docAdjuntos\"" {
               Wiki{"Marque todos los documentos anexos y luego seleccione. Cada nueva selección sobrescribirá la anterior."}
               Tabla tblDocAdicionales campo=SolicitudGenerica.documentacion.documentos seleccionable="Seleccionar" titulo="Seleccione"{
                  Columna titulo="Descripción" campo=Documento.descripcionVisible expandir
                  Columna titulo="Descargar" campo=Documento.enlaceDescarga expandir
                  Columna titulo="Descargar Firmado" campo=Documento.enlaceDescargaFirmado expandir
               }
            }
            
            Grupo titulo="Documentación asociada a la comunicación" mostrarSiExpresion "comunicacionInterna.estado == \"docAdjuntos\""{
               Tabla documentosCI campo=ComunicacionInterna.asiento.uris titulo="Documento y anexos"
               popupBorrar=PopupBorrarDocumentosAsociadosAltaCI nombreBotonBorrar="Excluir"{
                  Columna campo=Documento.descripcionVisible titulo="Descripción del documento" expandir
                  Columna titulo="Descargar" campo=Documento.enlaceDescarga expandir
                  Columna titulo="Descargar Firmado" campo=Documento.enlaceDescargaFirmado expandir
               }
            }
            
            Grupo titulo= "Comentarios" {
               AreaTexto observaciones titulo="Observaciones" campo=ComunicacionInterna.asiento.observaciones
            }
         }
         
         Boton btnNuevoAsiento titulo="Enviar" waitPopup style="float : right;"
      }
	} 
}