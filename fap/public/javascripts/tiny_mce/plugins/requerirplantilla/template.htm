<html xmlns="http://www.w3.org/1999/xhtml">
<head>
	<title>{#template_dlg.title}</title>
	<script type="text/javascript" src="../../tiny_mce_popup.js"></script>
	<script type="text/javascript" src="js/template.js"></script>
	<link href="css/template.css" rel="stylesheet" type="text/css" />
	<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.7/jquery.min.js" type="text/javascript"></script>
</head>
<body onresize="RequerirPlantillaDialog.resize();"> 
    <script>
            //**********************************************************************************
            // Recogemos los datos del json devuelto por el controlador insertarImagen, para crear las
            // <option> del <select>. En el value del option concatenamos (separado por una coma) 
            // el id de la plantilla y la ruta de la misma
            //**********************************************************************************
            $.getJSON(tinyMCE.settings.httpPath + '/plantillasdoccontroller/insertarPlantilla', function(data) {   
	           $.each(data, function(key,value) {
	                $("#tpath").append('<option value="' + value.idPlantilla + '|' + value.ruta + '|' + value.descripcion + '">' + value.nombrePlantilla + '</option>');
	           });  
	        });
	        //**********************************************************************************
	        // Obtenemos la ruta del value del option actualmente seleccionado en el select
	        //**********************************************************************************
	        function getRuta(value) {
	            return value.split("|")[1];
	        }
	        //**********************************************************************************
	        // Obtenemos la descripci√≥n del value del option actualmente seleccionado en el select
	        //**********************************************************************************
	        function getDescripcion(value) {
	            return value.split("|")[2];
	        }
    </script>


	<form onsubmit="RequerirPlantillaDialog.insert();return false;">
		<div id="frmbody">
			<div class="title">{#template_dlg.desc}</div>
			<div class="frmRow"><label for="tpath" title="{#template_dlg.select}">{#template_dlg.label}</label>:
			<select id="tpath" name="tpath" onchange="RequerirPlantillaDialog.selectTemplate( getRuta(this.options[this.selectedIndex].value), this.options[this.selectedIndex].text, getDescripcion(this.options[this.selectedIndex].value) );" class="mceFocus">
				<option value="">{#template_dlg.select}...</option>
			</select>
			<span id="warning"></span></div>
			<div class="frmRow"><label for="tdesc">{#template_dlg.desc_label}</label>:
			<span id="tmpldesc"></span></div>
			<fieldset>
				<legend>{#template_dlg.preview}</legend>
				<iframe id="templatesrc" name="templatesrc" src="blank.htm" width="690" height="400" frameborder="0"></iframe>
			</fieldset>
		</div>
		
		<div class="mceActionPanel">
			<input type="submit" id="insert" name="insert" value="{#insert}" />
			<input type="button" id="cancel" name="cancel" value="{#cancel}" onclick="tinyMCEPopup.close();" />
		</div>
	</form>
</body> 
</html> 
